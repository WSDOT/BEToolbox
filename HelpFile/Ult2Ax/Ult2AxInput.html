<!

///////////////////////////////////////////////////////////////////////
// BEToolbox - Bridge Engineering Toolbox
// Copyright (C) 2000, Washington State Department of Transportation
//                     Bridge and Structures Office
//
// This software was developed as part of the Alternate Route Project
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the Alternate Route Open Source License as
// published by the Washington State Department of Transportation,
// Bridge and Structures Office.
//
// This program is distributed in the hope that it will be useful,
// but is distributed AS IS, WITHOUT ANY WARRANTY; without even the
// implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
// PURPOSE.  See the Alternate Route Open Source License for more details.
//
// You should have received a copy of the Alternate Open Source License
// along with this program; if not, write to the Washington State
// Department of Transportation, Bridge and Structures Office,
// 4500 3rd Ave SE, P.O. Box 47340, Olympia, WA 98503, USA or e-mail
// Bridge_Support@wsdot.wa.gov
///////////////////////////////////////////////////////////////////////

>

<HTML>
  <HEAD>
    <TITLE>Ult2Ax Input</TITLE>
    <STYLE TYPE="text/css">
      .select {text-align:center; font-family: Arial; font-weight: bold; color: white; cursor: hand}
      body {margin-top: 0pt}
     .contents {background: blue; font-family: Arial; color: black}
	TD {font-size: 14; font-weight: bold}
    </STYLE>
	<object
	   classid="clsid:A1502462-F14D-11D3-933C-006097DF3C68" id="Shapes">
	</object>
  </HEAD>

<SCRIPT LANGUAGE="JavaScript">
// javascript used to manipulate form.  vbscript used to manipulate data.
// visual basic used to manipulate files.  fortran used to process data.

// Note: Throughout this page and others, the ".\..\" are dos paths for HTML and the "./../" are unix path's for
//  javascript..MUST be this way IAW http://www.cis.ohio-state.edu/htbin/rfc/rfc1738.html>

	//This variable and the next two functions help to show/hide the entire form.
	// useful in making it so header shows when form is minimized.
	// Also deselects text that may have been selected accidentally when document is clicked on.
	var bJustMaximized = false;

	function SetJustMaximized()
	{	// Page was just maximized (from a small frame to a large one)
		bJustMaximized = true;
	}

	function CheckMinimized()
	{	// Document's just been maximized, so show the page and unselect anything selected
		if( bJustMaximized == true )
		{
			//document.all.InputFormFull.style.display="";
			document.all.FormExcludingHeading.style.display="";
			bJustMaximized = false;
			if ( "None" != document.selection.type )
			{
				document.selection.empty();
			}
		}
	}


	function optAreaChanged()
	{
		// Do something when the option box changes.
		// Get data on "new" selected shape, and display it
		CurrentShape = document.all.optArea.selectedIndex + 1;
		ClearVertices();

		// Find out how many rows of points (vertices) there are:
		tmpVertice = Shapes.Item(CurrentShape).Count;

		//Add text boxes:
		for( var count = 2; count <= tmpVertice; count++ )
		{
			ShowVertices();
		}

		// Set fc:
		document.all.txtfc.value = Shapes.Item(CurrentShape).fc;

		// Set set boxes:
		for( var count = 1; count <= Vertice; count++ )
		{
			var textBoxName = "Text" + count + "1"
			document.all.item(textBoxName).value = Shapes.Item(CurrentShape).Item(count).X;
			textBoxName = "Text" + count + "2";
			document.all.item(textBoxName).value = Shapes.Item(CurrentShape).Item(count).Y;
		}
	}


	function ShapesUpdate( location, X, Y )
	{
		Shapes.Item(CurrentShape).Item(location).X = X;
		Shapes.Item(CurrentShape).Item(location).Y = Y;
	}


	function fcUpdate( fcValue )
	{
		Shapes.Item(CurrentShape).fc = fcValue;
	}


	function BodyLoad()
	{
		//Erases buttons that need to be linked in for compiler to see them
		document.all.EraseMe1.innerHTML="";
		document.all.EraseMe2.innerHTML="";
		document.all.EraseMe3.innerHTML="";
		document.all.EraseMe4.innerHTML="";
		document.all.EraseMe5.innerHTML="";
		document.all.EraseMe6.innerHTML="";
		// Form just loaded and only one of each problem exists
		Vertice = 1;
		Area = 1;
		Strand = 1;
		IndRebar = 1;
		RebarLine = 1;
		Magnitude = 1;
   		Shapes.Add("", "");
		Shapes.Item(1).Add("", "", "");
		CurrentShape = 1;
	}


	function clickedOn(my)
	{	//Clicked on form, so expand it and change color (old color = Blue)
		parent.display(my, "Blue");
	}

	function LoadFile()	// Load from a file
	{
		var SavedFileData = parent.LoadFile();
		if( SavedFileData != "")
		{
			ClearForm();
			Parse(SavedFileData);
		}
		focus();	//The button was given the focus, now return it to the form.
	}

	function SaveFile()	//Save to a file
	{
		var dataString = CreateSaveString();
		parent.SaveFile( dataString );
		focus();	//The button was given the focus, now return it to the form.
	}

	function Process()	//Called from "Output" page...this processes the data w/Fortran dll
	{
		var dataString = CreateFortranSaveString();
		parent.SetInputString( dataString );
		parent.Process();
	}

	function AddVertice()		//Adds one row of problems
	{
		// Add row to text boxes:
		var strHTML = document.all.frmConcreteCoordinates.innerHTML;
		document.all.frmConcreteCoordinates.innerHTML = NewVertice( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.

		// Add point to "Shape" object in VB Core:
		Shapes.Item(CurrentShape).Add("", "", "");
	}


	function ShowVertices()		//Adds one row of problems w/o adding a point to the Shape object
	{
		// Add row to text boxes:
		var strHTML = document.all.frmConcreteCoordinates.innerHTML;
		document.all.frmConcreteCoordinates.innerHTML = NewVertice( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.
	}

	function RemoveVertice()	// Remove one row of problems and remove internal data
	{
		if( Vertice > 1 )
		{	// Deletes row of text boxes:
			document.all.frmConcreteCoordinates.innerHTML =
				GetUpToNextToLastVertexRow( document.all.frmConcreteCoordinates.innerHTML );
			Vertice--;

			//Deletes last "Shape" object in VB Core:
			var iTotalShapes = Shapes.Item(CurrentShape).Count;
			Shapes.Item(CurrentShape).Remove( iTotalShapes );
		}
	}

	function CleanVertice()	//Remove one row of problems, keep internal data
	{
		if( Vertice > 1 )
		{	// Deletes row of text boxes:
			document.all.frmConcreteCoordinates.innerHTML =
				GetUpToNextToLastVertexRow( document.all.frmConcreteCoordinates.innerHTML );
			Vertice--;
		}
	}

	function addNewOption( text )
	{
		var element = document.createElement( "OPTION" );
		element.text = text;
		document.all.optArea.options.add( element );
	}

	function AddArea()		// Adds one row of problems
	{
		// All area textboxes only named with numbers.  Makes using the VB object model much easier.
		CurrentShape = Shapes.Count + 1;
   		Shapes.Add("", "");
		Shapes.Item(CurrentShape).Add("", "", "");
		// This might possibly cause errors because the following function changes the text boxes and
		//   this might in turn try to access the shapes item that we have just moved from.
		//   Just keep this in mind and be prepared to modify the code in this function.
		ClearVertices();
		txtfc.value = "";
		addNewOption( CurrentShape );
		document.all.optArea.selectedIndex = CurrentShape - 1;
	}

	function RemoveArea()		// Remove one row of problems.
	{
		if( Shapes.count > 1 )
		{
			Shapes.Remove(CurrentShape);
			if( CurrentShape > 1 )
			{
				var tmpIndex = document.all.optArea.selectedIndex - 1;
			}
			if( CurrentShape > 1 )
			{
				CurrentShape = CurrentShape - 1;
			}
			// Remove items from combo box:
			for( count = 0; count < ( Shapes.count + 1 ); count++ )
			{
				document.all.optArea.options.remove(0);
			}
			// Repopulate combo box:
			for( count = 1; count <= Shapes.Count ; count++ )
			{
				addNewOption( count );
			}
			document.all.optArea.selectedIndex = tmpIndex;
			optAreaChanged();
		}
		else
		{
			Shapes.Item(CurrentShape).fc = "";
			Shapes.Item(CurrentShape).Item(1).X = "";
			Shapes.Item(CurrentShape).Item(1).Y = "";
			document.all.txtfc.value = "";
			ClearVertices();
		}
	}

	function AddStrand()		//Adds one row of problems
	{
		var strHTML = document.all.frmStrands.innerHTML;
		document.all.frmStrands.innerHTML = NewStrand( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.
	}

	function RemoveStrand()		//Remove one row of problems.
	{
		if( Strand > 1 )
		{
			document.all.frmStrands.innerHTML =
				GetUpToNextToLastStrandRow( document.all.frmStrands.innerHTML);
			Strand--;
		}
	}

	function AddIndRebar()		//Adds one row of problems
	{
		var strHTML = document.all.frmRebar.innerHTML;
		document.all.frmRebar.innerHTML = NewIndRebar( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.
	}

	function RemoveIndRebar()	//Remove one row of problems.
	{
		if( IndRebar > 1 )
		{
			document.all.frmRebar.innerHTML =
				GetUpToNextToLastIndRebarRow( document.all.frmRebar.innerHTML);
			IndRebar--;
		}
	}

	function AddRebarLine()		//Adds one row of problems
	{
		var strHTML = document.all.frmRebarLines.innerHTML;
		document.all.frmRebarLines.innerHTML = NewRebarLine( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.
	}

	function RemoveRebarLine()	//Remove one row of problems.
	{
		if( RebarLine > 1 )
		{
			document.all.frmRebarLines.innerHTML =
				GetUpToNextToLastRebarLineRow( document.all.frmRebarLines.innerHTML);
			RebarLine--;
		}
	}

	function AddMagnitude()		//Adds one row of problems
	{
		var strHTML = document.all.frmAxialLoad.innerHTML;
		document.all.frmAxialLoad.innerHTML = NewMagnitude( strHTML );
		//Don't have to increment the variable cuz the last function does that for us.
	}

	function RemoveMagnitude()	//Remove one row of problems.
	{
		if( Magnitude > 1 )
		{
			document.all.frmAxialLoad.innerHTML =
				GetUpToNextToLastAxialRow( document.all.frmAxialLoad.innerHTML);
			Magnitude--;
		}
	}

</SCRIPT>

<SCRIPT LANGUAGE="VBScript">

	'Keeps track of which "shape" is the current one:  <"Shapes" are kept in VB core code>
	Dim CurrentShape

	'Keeps track of how many of each problem there is:
	Dim Vertice
	Dim Strand
	Dim IndRebar
	Dim RebarLine
	Dim Magnitude


	Sub ShapesChanged
		Dim optString
		Dim tmpString
		Dim count
		'tmpString = "<DIV id=AreasOption><TD width=50><SELECT id=optArea ONCHANGE=""optAreaChanged()"">"
		For count = 1 to Shapes.Count
			optString = optString + "<OPTION selected>" + Cstr(count) + "</OPTION>"
		Next
		'tmpString = tmpString + optString
		'tmpString = tmpString + "</SELECT></TD></DIV>"
		'document.all.AreasOption.innerHTML = tmpString
		document.all.optArea.innerHTML = optString
	End Sub


	Sub ClearForm
		' Clears textboxes, etc
		Dim count
		Dim strTextBoxName
		Dim textBox

		'Get rid of excess areas:
		While Shapes.Count > 1
			RemoveArea
		Wend

		'Clear out Vertices and deleted internal data:
		While Shapes.Item(1).Count > 1
			RemoveVertice
		Wend
		'Clear out text boxes:
		document.all.Text11.value = ""
		document.all.Text12.value = ""

		'Remove remaining Shape object, then replace it with a new, clean one:
		Shapes.Remove 1
   		Shapes.Add "", ""
		Shapes.Item(1).Add "", "", ""

		'Get rid of extra strands:
		While Strand > 1
			RemoveStrand
		Wend
		'Clear out what's left in strand text boxes:
		For count = 1 to 4
			strTextBoxName = "txtStrand1" + Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

		'Get rid of extra Individual bars:
		While IndRebar > 1
			RemoveIndRebar
		Wend
		'Clear out what's left in IndRebar text boxes:
		For count = 1 to 3
			strTextBoxName = "txtRebar1" + Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

		'Get rid of extra Rebar Lines:
		While RebarLine > 1
			RemoveRebarLine
		Wend
		'Clear out what's left in Rebar Lines text boxes:
		For count = 1 to 6
			strTextBoxName = "txtNoRebar1" + Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

		'Clear out what's left in yield text boxes:
		document.all.txtYield11.value = ""
		document.all.txtYield12.value = ""

		'Clear out the readings:
		document.all.txtReadingsNo.value = ""

		'Set the readings combo box to index 0:
		document.all.optReading.selectedIndex = 0

		'Clear out the txtAxial boxes:
		document.all.txtAxialX.value = ""
		document.all.txtAxialY.value = ""

		'Get rid of extra magnitude boxes:
		While Magnitude > 1
			RemoveMagnitude
		Wend
		'Clear out what's left in magnitude text boxe:
		document.all.txtMag1.value = ""

	End Sub


	Sub ClearVertices
		'Clears out Vertices without deleting data:
		While Vertice > 1
			CleanVertice
		Wend
		document.all.Text11.value = ""
		document.all.Text12.value = ""

	End Sub


    Sub Parse(text)
        'This takes the input string (from file), parses it, and then places the data inside
        '     the form.
        Dim iStartOfWord      'These are used to pull the entry out of the file
        Dim iEndOfWord
        Dim iEndOfString
        Dim count             'cycles through the file
	Dim count2		'for use where needed
        Dim strWord
        Dim iLengthOfWord
	Dim iCurrentTextBox
        Dim strBoxName
        Dim textBox
	Dim iCurrentShape
	Dim iCurrentVertice
	Dim iCurrentStrand
	Dim iCurrentIndBars
	Dim iCurrentRebarLines
	Dim iCurrentMagnitudes
					'The following bool's tell us which section of the form we are in.
	Dim bShapes
	Dim bVert
	Dim bStrands
	Dim bIndBars
	Dim bRebarLines
	Dim bYield
	Dim bReadings
	Dim bMagnitude
	Dim cCurrentPoint

'On Error Resume Next

	bShapes = false
	bVert = false
	bStrands = false
	bIndBars = false
	bRebarLines = false
	bYield = false
	bReadings = false
	bMagnitude = false
        iEndOfString = Len(text)
        count = 1
        iStartOfWord = 0
        iEndOfWord = 1
	iCurrentTextBox = 0
	iCurrentShape = 0
	iCurrentVertice = 0
	iCurrentStrand = 0
	iCurrentIndBars = 0
	iCurrentRebarLines = 0
	iCurrentMagnitudes = 0

        'ClearForm
        Vertice = 1
        Area = 1
        Strand = 1
        IndRebar = 1
        RebarLine = 1
        Magnitude = 1
        CurrentShape = 1

        For count = 1 To iEndOfString
        'If parser finds an entry:

            If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13)) Or _
			(Mid(text, count, 1) = Chr(10))) Then
            '-----Move to the next textbox or line depending on current position in line
                If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13))) Then
			  iCurrentTextBox = iCurrentTextBox + 1
                ElseIf Mid(text, count, 1) = Chr(10) Then
			  iCurrentTextBox = 0
                End If

                '----Get a hold of the entry and assign to "strWord"
                iEndOfWord = count
                iLengthOfWord = ((iEndOfWord - 1) - (iStartOfWord))
                strWord = Mid(text, iStartOfWord + 1, iLengthOfWord)
                If Left(strWord, 1) = Chr(10) Then strWord = Mid(strWord, 2, (Len(strWord) - 1))
                iStartOfWord = iEndOfWord

                'If ((strWord <> Chr(13)) And (strWord <> Chr(10)) _
                ' 			And (strWord <> "")) Then
				'If ((iCurrentTextBox = 1) And (iCurrentTextBoxRow > 1)) Then AddProblem()
				'strBoxName = "Line" + Cstr(iCurrentTextBoxRow) + Cstr(iCurrentTextBox)
				'Set textBox = document.all.Item(strBoxName)
				'textBox.value = strWord
                'End If

			'Determine which section we are in:
			Select Case strWord
				Case "<SHAPES>"
					bShapes = true
				Case "<VERT>"
					bVert = true
				Case "<STRANDS>"
					bStrands = true
				Case "<INDBARS>"
					bIndBars = true
				Case "<REBARLINES>"
					bRebarLines = true
				Case "<YIELD>"
					bYield = true
				Case "<READINGS>"
					bReadings = true
				Case "<MAGNITUDES>"
					bMagnitude = true
			End Select

			'Based on which section we're in, perform various actions:
			If bShapes = true Then
				If iCurrentTextBox = 2 Then
					'Add as many areas as we need
					tmpAreas = Cint(strWord)
					For count2 = 2 to tmpAreas
						AddArea
					Next
					If iCurrentShape < 1 Then
						iCurrentShape = 1
						CurrentShape = 1		'Global
					End If
					bShapes = false
				End If
			ElseIf bVert = true Then
				If iCurrentTextBox = 2 Then
					'Set the "Shape" to the current shape
					document.all.optArea.selectedIndex = ( iCurrentShape - 1 )
					optAreaChanged

					'Add as many vertices as we need
					tmpVertices = Cint(strWord)
					For count2 = 2 to tmpVertices
						AddVertice
					Next
					If iCurrentVertice < 1 Then iCurrentVertice = 1
					'iCurrentVertice = 1
				ElseIf iCurrentTextBox = 3 Then
					Shapes.Item(iCurrentShape).fc = Cstr(strWord)
				ElseIf ( ( iCurrentTextBox > 3 ) And ( iCurrentVertice <= Vertice ) ) Then
					If cCurrentPoint = "" Then
						cCurrentPoint = "X"
					End If
					If cCurrentPoint = "X" Then
						Shapes.Item(iCurrentShape).Item(iCurrentVertice).X = strWord
						cCurrentPoint = "Y"
					ElseIf cCurrentPoint = "Y" Then
						Shapes.Item(iCurrentShape).Item(iCurrentVertice).Y = strWord
						cCurrentPoint = "X"
						iCurrentVertice = iCurrentVertice + 1
					End If
				'ElseIf cCurrentPoint = "X" Then
				'	iCurrentVertice = iCurrentVertice + 1
				ElseIf ( ( iCurrentVertice => Vertice ) And ( cCurrentPoint = "X" ) _
					And ( iCurrentTextBox <> 1 ) )Then
					bVert = false
					iCurrentVertice = 1
					iCurrentShape = iCurrentShape + 1
					CurrentShape = CurrentShape + 1		'Global
					'iCurrentVertice = 1
					'Vertice = 1
				End If
			ElseIf bStrands = true Then
				''We are now totally done dealing with vertices and shapes, so set the form to
				''  the first shape:
				'document.all.optArea.selectedIndex = 0
				'optAreaChanged

				If iCurrentTextBox = 2 Then
					'Go ahead and fill up the textboxes for the strands now:
					'Add as many strands as we need
					tmpStrands = Cint(strWord)
					For count2 = 2 to tmpStrands
						AddStrand
					Next

					iCurrentStrand = 1
					iCurrentEntry = 1

				ElseIf iCurrentTextBox > 2 Then
					If iCurrentStrand <= Strand Then
						strBoxName = "txtStrand" + Cstr(iCurrentStrand) + Cstr(iCurrentEntry)
						Set textBox = document.all.Item(strBoxName)
						textBox.value = strWord
						If ( iCurrentEntry = 4 ) Then
							iCurrentStrand = iCurrentStrand + 1
							If ( ( iCurrentStrand > Strand ) And ( iCurrentEntry = 4 ) ) Then
								bStrands = false
							End If
							iCurrentEntry = 0
						End If
						iCurrentEntry = iCurrentEntry + 1
					End If
				End If
			ElseIf bIndBars = true Then
				If iCurrentTextBox = 2 Then
					'Add as many indbars as we need
					tmpRebar = Cint(strWord)
					For count2 = 2 to tmpRebar
						AddIndRebar
					Next
					iCurrentIndBars = 1
					iCurrentEntry = 1
				ElseIf iCurrentTextBox > 2 Then
					If iCurrentIndBars <= IndRebar Then
						strBoxName = "txtRebar" + Cstr(iCurrentIndBars) + Cstr(iCurrentEntry)
						Set textBox = document.all.Item(strBoxName)
						textBox.value = strWord
						If ( iCurrentEntry = 3 ) Then
							If iCurrentIndBars = IndRebar Then
								bIndBars = false
							End If
							iCurrentIndBars = iCurrentIndBars + 1
							iCurrentEntry = 0
						End If
						iCurrentEntry = iCurrentEntry + 1
					'Else
					'	bIndBars = false
					End If
				End If
			ElseIf bRebarLines = true Then
				If iCurrentTextBox = 2 Then
					'Add as many Rebar lines as we need
					tmpRebarLines = Cint(strWord)
					For count2 = 2 to tmpRebarLines
						AddRebarLine
					Next
					iCurrentRebarLines = 1
					iCurrentEntry = 1
				ElseIf iCurrentTextBox > 2 Then
					If iCurrentRebarLines <= RebarLine Then
						strBoxName = "txtNoRebar" + Cstr(iCurrentRebarLines) + Cstr(iCurrentEntry)
						Set textBox = document.all.Item(strBoxName)
						textBox.value = strWord
						If ( iCurrentEntry = 6 ) Then
							iCurrentRebarLines = iCurrentRebarLines + 1
							iCurrentEntry = 0
							If iCurrentRebarLines > RebarLine Then bRebarLines = false
						End If
						iCurrentEntry = iCurrentEntry + 1
					End If
					'If ( ( iCurrentEntry > 6 ) And ( iCurrentRebarLines => RebarLine ) ) Then
					'	bRebarLines = false
					'End If
				End If
			ElseIf bYield = true Then
				If iCurrentTextBox = 1 Then
					'Do nothing
				ElseIf iCurrentTextBox = 2 Then
					document.all.txtYield11.value = strWord
				ElseIf iCurrentTextBox = 3 Then
					document.all.txtYield12.value = strWord
					bYield = false
				End If
			ElseIf bReadings = true Then
				If iCurrentTextBox = 1 Then
					'Do nothing
				ElseIf iCurrentTextBox = 2 Then
					document.all.txtReadingsNo.value = strWord
				ElseIf iCurrentTextBox = 3 Then
					Select Case strWord
						Case "0"
							document.all.optReading.selectedIndex = 0
						Case "90"
							document.all.optReading.selectedIndex = 1
						Case "180"
							document.all.optReading.selectedIndex = 2
						Case "360"
							document.all.optReading.selectedIndex = 3
						Case Else
							msgbox "File could not be loaded.  File may be corrupted."
					End Select
					'document.all.txtReadingsNo.value = strWord
					bReadings = false
				End If
			ElseIf bMagnitude = true Then
				If iCurrentTextBox = 1 Then
					'Do nothing
				ElseIf iCurrentTextBox = 2 Then
					tmpMagnitude = strWord
					For count2 = 2 to Cint(strWord)
						AddMagnitude
					Next
				ElseIf iCurrentTextBox = 3 Then
					document.all.txtAxialX.value = strWord
				ElseIf iCurrentTextBox = 4 Then
					document.all.txtAxialY.value = strWord
					iCurrentMagnitudes = 1
				ElseIf ( ( iCurrentTextBox > 3 ) And ( iCurrentTextBox <= (cInt(tmpMagnitude)+4) ) ) Then
					strBoxName = "txtMag" + Cstr(iCurrentMagnitudes)
					Set textBox = document.all.Item(strBoxName)
					textBox.value = strWord
					iCurrentMagnitudes = iCurrentMagnitudes + 1
				End If
				If ( iCurrentTextBox = (tmpMagnitude + 4) ) Then
					bMagnitude = false
					count = iEndOfString
				End If
			Else
				'Do nothing
			End If
		  End If
        Next

		'We are now totally done dealing with vertices and shapes, so set the form to
		'  the first shape:
		document.all.optArea.selectedIndex = 0
		optAreaChanged

'Parse Error:
If Err.Number > 4 Then
	msgbox "You may be using a corrupted file.  Please contact Software Support."
	Exit Sub
End If

    End Sub


'	Function RowIsEmpty( txtBoxName, NoOfCol )
'		Dim textBox
'		Dim bIsEmpty
'
'		bIsEmpty = true
'
'		For count = 1 to NoOfCol
'			Set textBox = document.all.Item(txtBoxname)
'			If ( ( textBox.value <> "" ) And ( bIsEmpty = true ) ) Then
'				bIsEmpty = false
'			End If
'
'			'The following comments show the basic algorithm.  Notice that only one "If"
'			'  contains anything.  Therefore, this is the only one that I use above.
'			'If ( ( textBox.value = "" ) And ( bIsEmpty = true ) )  Then
'			'	'Do Nothing
'			'ElseIf ( ( textBox.value = "" ) And ( bIsEmpty = false ) )
'			'	'Do Nothing
'			'ElseIf ( ( textBox.value <> "" ) And ( bIsEmpty = true ) ) Then
'			'	bIsEmpty = false
'			'ElseIf ( ( textBox.value <> "" ) And ( bIsEmpty = false ) ) Then
'			'	'Do Nothing
'			'End If
'		Next
'
'		RowIsEmpty = bIsEmpty
'	End Function


	Function CreateSaveString()    'For a file...not for Fortran
		Dim strName
		Dim textBox
		Dim textBoxName
		Dim count
		Dim count2
		Dim count3
		Dim tmpLineString
		Dim tmpFullString
		tmpLineString = ""
		tmpFullString = ""

		' Tell how many shapes there are.
		tmpLineString = "<SHAPES>," + Cstr(Shapes.Count) + Chr(13) + Chr(10)

		'Get the vertices
		For count = 1 to Shapes.Count
			' Tell how many vertices there are in the first shape
			tmpLineString = tmpLineString & "<VERT>," + Cstr(Shapes.Item(count).Count) & "," & _
				 Cstr(Shapes.Item(count).fc) & ","
			For count2 = 1 to Shapes.Item(count).Count
'			        If Trim(Shapes.Item(count).Item(count2).X) = "" Then
'			                tmpLineString = tmpLineString & "0,"
'			        Else
			                tmpLineString = tmpLineString & Trim(Shapes.Item(count).Item(count2).X) & ","
'			        End If

'				If Trim(Shapes.Item(count).Item(count2).Y) = "" Then
'				        tmpLineString = tmpLineString & "0,"
'				Else
				        tmpLineString = tmpLineString & Trim(Shapes.Item(count).Item(count2).Y) & ","
'				End If

			Next

			'Get rid of last comma in line:
			tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
			'Add linefeed:
			tmpLineString = tmpLineString + Chr(13) + Chr(10)
		Next

		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		'Get the strands:
		tmpLineString = tmpLineString + "<STRANDS>," + Cstr(Strand) + ","
		For count = 1 to Strand
			For count2 = 1 to 4
				textBoxName = "txtStrand" + Cstr(count) + Cstr(count2)
				Set textBox = document.all.Item(textBoxName)
				tmpLineString = tmpLineString + textBox.value & ","
			Next
		Next
		'Get rid of last comma in line:
		tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
		'Add linefeed:
		tmpLineString = tmpLineString + Chr(13) + Chr(10)
		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		'Get the individual rebars:
		tmpLineString = tmpLineString + "<INDBARS>," + Cstr(IndRebar) + ","
		For count = 1 to IndRebar
			For count2 = 1 to 3
				textBoxName = "txtRebar" + Cstr(count) + Cstr(count2)
				Set textBox = document.all.Item(textBoxName)
				tmpLineString = tmpLineString + textBox.value & ","
			Next
		Next
		'Get rid of last comma in line:
		tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
		'Add linefeed:
		tmpLineString = tmpLineString + Chr(13) + Chr(10)
		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		'Get rebar lines:
		tmpLineString = tmpLineString + "<REBARLINES>," + Cstr(RebarLine) + ","
		For count = 1 to RebarLine
			For count2 = 1 to 6
				textBoxName = "txtNoRebar" + Cstr(count) + Cstr(count2)
				Set textBox = document.all.Item(textBoxName)
				tmpLineString = tmpLineString + textBox.value & ","
			Next
		Next
		'Get rid of last comma in line:
		tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
		'Add linefeed:
		tmpLineString = tmpLineString + Chr(13) + Chr(10)
		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		tmpLineString = tmpLineString & "<YIELD>," & document.all.txtYield11.value & ","
		tmpLineString = tmpLineString & document.all.txtYield12.value + Chr(13) + Chr(10)

		tmpLineString = tmpLineString & "<READINGS>," & document.all.txtReadingsNo.value & ","

		'The additional "1" is to provide a default input for the fortran.
		Select Case document.all.optReading.selectedIndex
			Case 0
				tmpLineString = tmpLineString + "0" + Chr(13) + Chr(10)
			Case 1
				tmpLineString = tmpLineString + "90" + Chr(13) + Chr(10)
			Case 2
				tmpLineString = tmpLineString + "180" + Chr(13) + Chr(10)
			Case 3
				tmpLineString = tmpLineString + "360" + Chr(13) + Chr(10)
		End Select

		tmpLineString = tmpLineString + "<MAGNITUDES>," + Cstr( Magnitude ) + ","

		tmpLineString = tmpLineString & document.all.txtAxialX.value & ","
		tmpLineString = tmpLineString & document.all.txtAxialY.value & ","

		For count = 1 to Magnitude
			textBoxName = "txtMag" + Cstr(count)
			Set textBox = document.all.Item(textBoxName)
			tmpLineString = tmpLineString + textBox.value & ","
		Next

		'Get rid of last comma in line:
		tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)

		tmpLineString = tmpLineString + Chr(13) + Chr(10)

		tmpFullString = tmpFullString + tmpLineString

		CreateSaveString = tmpFullString
		Set textBox = nothing
	End Function


	Function CreateFortranSaveString()     'Takes form data and converts it to a string
				 			   ' used for processing by the Fortran dll
		Dim strName
		Dim textBox
		Dim textBoxName
		Dim count
		Dim count2
		Dim count3
		Dim tmpLineString
		Dim tmpFullString
		tmpLineString = ""
		tmpFullString = ""

		'If there are no shapes and vertices, then print "0"'s, otherwise, fill in info.
		If ( ( ( Shapes.Item(1).fc = "0" ) Or ( Trim(Shapes.Item(1).fc) = "" ) ) _
			And ( ( Shapes.Item(1).fc = "0" ) Or ( Trim(Shapes.Item(1).fc) = "" ) ) _
			And ( ( Shapes.Item(1).Item(1).X = "0" ) Or ( Trim(Shapes.Item(1).Item(1).X) = "" ) ) _
			And ( ( Shapes.Item(1).Item(1).Y = "0" ) Or ( Trim(Shapes.Item(1).Item(1).Y) = "" ) ) ) _
			Then
				tmpLineString = tmpLineString & "0,0" + Chr(13) + Chr(10)
				tmpLineString = tmpLineString & "0" + Chr(13) + Chr(10)
		Else
			tmpLineString = Shapes.Count & ",0"
			tmpLineString = tmpLineString + Chr(13) + Chr(10)

			'Cycle through each shape:
			For count = 1 to Shapes.Count
			        tmpLineString = tmpLineString & Shapes.Item(count).Count & ","
				tmpLineString = tmpLineString & Shapes.Item(count).fc
				tmpLineString = tmpLineString + Chr(13) + Chr(10)
				'Cycle through each Vertice:
				For count2 = 1 to Shapes.Item(count).Count
			                tmpLineString = tmpLineString + Trim(Shapes.Item(count).Item(count2).X) & ","

				        tmpLineString = tmpLineString + _
                                                Shapes.Item(count).Item(count2).Y

					tmpLineString = tmpLineString + Chr(13) + Chr(10)
				Next
			Next
		End If

		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		If ( Strand = 1 _
			And (( document.all.txtStrand11.value = "0" ) Or ( Trim(document.all.txtStrand11.value) = "" )) _
			And (( document.all.txtStrand12.value = "0" ) Or ( Trim(document.all.txtStrand12.value) = "" )) _
			And (( document.all.txtStrand13.value = "0" ) Or ( Trim(document.all.txtStrand13.value) = "" )) _
			And (( document.all.txtStrand14.value = "0" ) Or ( Trim(document.all.txtStrand14.value) = "" )) ) _
			Then
			tmpLineString = "0" + Chr(13) + Chr(10)
		Else
			tmpLineString = tmpLineString + Cstr(Strand)
			tmpLineString = tmpLineString + Chr(13) + Chr(10)
			For count = 1 to Strand
				For count2 = 1 to 4
					textBoxName = "txtStrand" + Cstr(count) + Cstr(count2)
					Set textBox = document.all.Item(textBoxName)
				        tmpLineString = tmpLineString + Trim(textBox.value) & ","
				Next
				'Get rid of last comma in line:
				tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
				'Add linefeed:
				tmpLineString = tmpLineString + Chr(13) + Chr(10)
			Next
		End If

		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		tmpLineString = tmpLineString + Cstr(IndRebar)
		tmpLineString = tmpLineString + Chr(13) + Chr(10)

		If ( IndRebar = 1 _
			And (( document.all.txtRebar11.value = "0" ) Or ( Trim(document.all.txtRebar11.value) = "" )) _
			And (( document.all.txtRebar12.value = "0" ) Or ( Trim(document.all.txtRebar12.value) = "" )) _
			And (( document.all.txtRebar13.value = "0" ) Or ( Trim(document.all.txtRebar13.value) = "" )) ) _
			Then
			tmpLineString = "0" + Chr(13) + Chr(10)
		Else
			For count = 1 to IndRebar
				For count2 = 1 to 3
					textBoxName = "txtRebar" + Cstr(count) + Cstr(count2)
					Set textBox = document.all.Item(textBoxName)
				        tmpLineString = tmpLineString + Trim(textBox.value) & ","
				Next
				'Get rid of last comma in line:
					tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
				'Add linefeed:
				tmpLineString = tmpLineString + Chr(13) + Chr(10)
			Next
		End If

		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

		tmpLineString = tmpLineString + Cstr(RebarLine)
		tmpLineString = tmpLineString + Chr(13) + Chr(10)

		If ( RebarLine = 1 _
			And (( document.all.txtNoRebar11.value = "0" ) Or ( Trim(document.all.txtNoRebar11.value) = "" )) _
			And (( document.all.txtNoRebar12.value = "0" ) Or ( Trim(document.all.txtNoRebar12.value) = "" )) _
			And (( document.all.txtNoRebar13.value = "0" ) Or ( Trim(document.all.txtNoRebar13.value) = "" )) _
			And (( document.all.txtNoRebar14.value = "0" ) Or ( Trim(document.all.txtNoRebar14.value) = "" )) _
			And (( document.all.txtNoRebar15.value = "0" ) Or ( Trim(document.all.txtNoRebar15.value) = "" )) _
			And (( document.all.txtNoRebar16.value = "0" ) Or ( Trim(document.all.txtNoRebar16.value) = "" )) ) _
			Then
			tmpLineString = "0" + Chr(13) + Chr(10)
		Else
			For count = 1 to RebarLine
				For count2 = 1 to 6
					textBoxName = "txtNoRebar" + Cstr(count) + Cstr(count2)
					Set textBox = document.all.Item(textBoxName)
				        tmpLineString = tmpLineString + Trim(textBox.value) & ","
				Next
				'Get rid of last comma in line:
				tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
				'Add linefeed:
				tmpLineString = tmpLineString + Chr(13) + Chr(10)
			Next
		End If

		tmpFullString = tmpFullString + tmpLineString
		tmpLineString = ""

                If Trim(document.all.txtYield11.value) = "" Then
                        tmpLineString = tmpLineString & "0,"
                Else
                        tmpLineString = tmpLineString & Trim(document.all.txtYield11.value) & ","
                End If

		If Trim(document.all.txtYield12.value) = "" Then
		        tmpLineString = tmpLineString & "0" + Chr(13) + Chr(10)
		Else
		        tmpLineString = tmpLineString & Trim(document.all.txtYield12.value) + Chr(13) + Chr(10)
		End If

                If Trim(document.all.txtReadingsNo.value) = "" Then
                        tmpLineString = tmpLineString & "0,"
                Else
                        tmpLineString = tmpLineString & Trim(document.all.txtReadingsNo.value) & ","
                End If


		'The additional "1" is to provide a default input for the fortran.
		Select Case document.all.optReading.selectedIndex
			Case 0
				tmpLineString = tmpLineString + "0,1" + Chr(13) + Chr(10)
			Case 1
				tmpLineString = tmpLineString + "90,1" + Chr(13) + Chr(10)
			Case 2
				tmpLineString = tmpLineString + "180,1" + Chr(13) + Chr(10)
			Case 3
				tmpLineString = tmpLineString + "360,1" + Chr(13) + Chr(10)
		End Select

		tmpLineString = tmpLineString + Cstr( Magnitude ) & ","

                If Trim(document.all.txtAxialX.value) = "" Then
                        tmpLineString = tmpLineString & "0,"
                Else
                        tmpLineString = tmpLineString & Trim(document.all.txtAxialX.value) & ","
                End If

		If Trim(document.all.txtAxialY.value) = "" Then
	        	tmpLineString = tmpLineString & "0"
		Else
        		tmpLineString = tmpLineString & Trim(document.all.txtAxialY.value)
		End If

		tmpLineString = tmpLineString + Chr(13) + Chr(10)

		If ( Magnitude = 1 _
			And ( Trim(document.all.txtMag1.value) = "0" ) Or ( Trim(document.all.txtMag1.value) = "" ) ) _
			Then
			tmpLineString = tmpLineString + "0" + Chr(13) + Chr(10)
		Else
			For count = 1 to Magnitude
				textBoxName = "txtMag" + Cstr(count)
				Set textBox = document.all.Item(textBoxName)
				If Trim(textBox.value) = "" Then
				        tmpLineString = tmpLineString + "0"
				Else
				        tmpLineString = tmpLineString + Trim(textBox.value)
				End If

				tmpLineString = tmpLineString + Chr(13) + Chr(10)
			Next
		End If

		tmpFullString = tmpFullString + tmpLineString

		CreateFortranSaveString = tmpFullString
		Set textBox = nothing

	End Function

'****************************************************************************************
'These "GetUpToNextToLast???Row" functions are used to dynamically delete rows of problems.
'  What these functions do is retrieve a "form", delete everything following the next-to-last-row
'  (thereby eliminating the last row), then appending the end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function GetUpToNextToLastVertexRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "</TABLE><TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\AddVerticeDarkButton.jpg"" id=""cmdAddVertice"" " & _
			"	ONMOUSEOUT=""cmdAddVertice.src='./../Buttons/AddVerticeDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddVertice.src='./../Buttons/AddVerticeLightButton.jpg'"" "& _
			"	ONCLICK=""AddVertice()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\DeleteVerticeDarkButton.jpg"" id=""cmdRemoveVertice"" " & _
			"	ONMOUSEOUT=""cmdRemoveVertice.src='./../Buttons/DeleteVerticeDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveVertice.src='./../Buttons/DeleteVerticeLightButton.jpg'"" " & _
			"	ONCLICK=""RemoveVertice()""></TD>" & _
			"<TD width=50></TD>" & _
			"<TD><IMG src="".\..\Buttons\AddAreaDarkButton.jpg"" id=""cmdAddArea"" " & _
			"	ONMOUSEOUT=""cmdAddArea.src='./../Buttons/AddAreaDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddArea.src='./../Buttons/AddAreaLightButton.jpg'"" " & _
			"	ONCLICK=""AddArea()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\DeleteAreaDarkButton.jpg"" id=""cmdDeleteArea"" " & _
			"	ONMOUSEOUT=""cmdDeleteArea.src='./../Buttons/DeleteAreaDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdDeleteArea.src='./../Buttons/DeleteAreaLightButton.jpg'"" " & _
 			"	ONCLICK=""RemoveArea()""></TD>" & _
			"</TABLE>"

		GetUpToNextToLastVertexRow = tmpString
	End Function


	Function GetUpToNextToLastStrandRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "</TABLE><TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddStrand"" " & _
			"	ONMOUSEOUT=""cmdAddStrand.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddStrand.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddStrand()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveStrand"" " & _
			"	ONMOUSEOUT=""cmdRemoveStrand.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveStrand.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveStrand()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		GetUpToNextToLastStrandRow = tmpString
	End Function


	Function GetUpToNextToLastIndRebarRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddIndRebar"" " & _
			"	ONMOUSEOUT=""cmdAddIndRebar.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddIndRebar.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddIndRebar()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveIndRebar"" " & _
			"	ONMOUSEOUT=""cmdRemoveIndRebar.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveIndRebar.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveIndRebar()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		GetUpToNextToLastIndRebarRow = tmpString
	End Function


	Function GetUpToNextToLastRebarLineRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddRebarLine"" " & _
			"	ONMOUSEOUT=""cmdAddRebarLine.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddRebarLine.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddRebarLine()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveRebarLine"" " & _
			"	ONMOUSEOUT=""cmdRemoveRebarLine.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveRebarLine.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveRebarLine()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		GetUpToNextToLastRebarLineRow = tmpString
	End Function



	Function GetUpToNextToLastAxialRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddMagnitude"" " & _
			"	ONMOUSEOUT=""cmdAddMagnitude.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddMagnitude.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddMagnitude()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveMagnitude"" " & _
			"	ONMOUSEOUT=""cmdRemoveMagnitude.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveMagnitude.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveMagnitude()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		GetUpToNextToLastAxialRow = tmpString
	End Function

'****************************************************************************************
'These "New???" functions are used to dynamically insert one new row (problems).
'  What these functions do is retrieve a "form", delete everything following the last-row
'  (the end tags), then appending the new row tags/end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function NewVertice( oldHTML )
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		Vertice = Vertice + 1
		'First parameter of function is the LINE that these text boxes are on
		strNewString = "<TR>" & _
			"<TD><INPUT id=""Text" + Cstr(Vertice) + "1"" size=""10"" " & _
				"ONCHANGE=""ShapesUpdate(" + Cstr(Vertice) + ",Text" + Cstr(Vertice) & _
				"1.value, Text" + Cstr(Vertice) + "2.value)""></TD>" & _
			"<TD><INPUT id=""Text" + Cstr(Vertice) + "2"" size=""10"" " & _
				"ONCHANGE=""ShapesUpdate(" + Cstr(Vertice) + ",Text" + Cstr(Vertice) & _
				"1.value, Text" + Cstr(Vertice) + "2.value)""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		strNewString = strNewString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\AddVerticeDarkButton.jpg"" id=""cmdAddVertice"" " & _
			"	ONMOUSEOUT=""cmdAddVertice.src='./../Buttons/AddVerticeDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddVertice.src='./../Buttons/AddVerticeLightButton.jpg'"" "& _
			"	ONCLICK=""AddVertice()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\DeleteVerticeDarkButton.jpg"" id=""cmdRemoveVertice"" " & _
			"	ONMOUSEOUT=""cmdRemoveVertice.src='./../Buttons/DeleteVerticeDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveVertice.src='./../Buttons/DeleteVerticeLightButton.jpg'"" " & _
			"	ONCLICK=""RemoveVertice()""></TD>" & _
			"<TD width=50></TD>" & _
			"<TD><IMG src="".\..\Buttons\AddAreaDarkButton.jpg"" id=""cmdAddArea"" " & _
			"	ONMOUSEOUT=""cmdAddArea.src='./../Buttons/AddAreaDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddArea.src='./../Buttons/AddAreaLightButton.jpg'"" " & _
			"	ONCLICK=""AddArea()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\DeleteAreaDarkButton.jpg"" id=""cmdDeleteArea"" " & _
			"	ONMOUSEOUT=""cmdDeleteArea.src='./../Buttons/DeleteAreaDarkButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdDeleteArea.src='./../Buttons/DeleteAreaLightButton.jpg'"" " & _
 			"	ONCLICK=""RemoveArea()""></TD>" & _
			"</TABLE>"

		NewVertice = oldHTML + strNewString
	End Function


	Function NewStrand( oldHTML )
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		Strand = Strand + 1
		strNewString = "<TR>" & _
			"<TD><INPUT id=""txtStrand" + Cstr(Strand) + "1"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtStrand" + Cstr(Strand) + "2"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtStrand" + Cstr(Strand) + "3"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtStrand" + Cstr(Strand) + "4"" size=""10""></TD>" & _
		   "</TR>" & _
		"</TABLE>"

		strNewString = strNewString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddStrand"" " & _
			"	ONMOUSEOUT=""cmdAddStrand.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddStrand.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddStrand()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveStrand"" " & _
			"	ONMOUSEOUT=""cmdRemoveStrand.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveStrand.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveStrand()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		NewStrand = oldHTML + strNewString
	End Function


	Function NewIndRebar( oldHTML )
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		IndRebar = IndRebar + 1
		strNewString = "<TR>" & _
			"<TD><INPUT id=""txtRebar" + Cstr(IndRebar) + "1"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtRebar" + Cstr(IndRebar) + "2"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtRebar" + Cstr(IndRebar) + "3"" size=""10""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		strNewString = strNewString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddIndRebar"" " & _
			"	ONMOUSEOUT=""cmdAddIndRebar.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddIndRebar.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddIndRebar()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveIndRebar"" " & _
			"	ONMOUSEOUT=""cmdRemoveIndRebar.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveIndRebar.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveIndRebar()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		NewIndRebar = oldHTML + strNewString
	End Function


	Function NewRebarLine( oldHTML )
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		RebarLine = RebarLine + 1
		strNewString = "<TR>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "1"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "2"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "3"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "4"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "5"" size=""10""></TD>" & _
			"<TD><INPUT id=""txtNoRebar" + Cstr(RebarLine) + "6"" size=""10""></TD>" & _
		   	"</TR>" & _
			"</TABLE>"


		strNewString = strNewString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddRebarLine"" " & _
			"	ONMOUSEOUT=""cmdAddRebarLine.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddRebarLine.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddRebarLine()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveRebarLine"" " & _
			"	ONMOUSEOUT=""cmdRemoveRebarLine.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveRebarLine.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveRebarLine()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		NewRebarLine = oldHTML + strNewString
	End Function


	Function NewMagnitude( oldHTML )
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		Magnitude = Magnitude + 1
		strNewString = "<TR>" & _
			"<TD><INPUT id=""txtMag" + Cstr(Magnitude) + """ size=""10""></TD>" & _
		   	"</TR>" & _
		   	"</TABLE>"

		strNewString = strNewString + "<TABLE>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR></TR>" & _
			"<TR>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddMagnitude"" " & _
			"	ONMOUSEOUT=""cmdAddMagnitude.src='./../Buttons/BoxDarkAddButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdAddMagnitude.src='./../Buttons/BoxLightAddButton.jpg'"" " & _
 			"	ONCLICK=""AddMagnitude()""></TD>" & _
			"<TD></TD>" & _
			"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveMagnitude"" " & _
			"	ONMOUSEOUT=""cmdRemoveMagnitude.src='./../Buttons/BoxDarkDeleteButton.jpg'"" " & _
			"	ONMOUSEOVER=""cmdRemoveMagnitude.src='./../Buttons/BoxLightDeleteButton.jpg'"" " & _
			"	ONCLICK=""RemoveMagnitude()""></TD>" & _
			"</TR>" & _
			"</TABLE>"

		NewMagnitude = oldHTML + strNewString
	End Function

'****************************************************************************************
' This function takes a piece of HTML retrieved from a "form", then gives you back the
'   HTML without the end tags (everything after the last row of problems).
'****************************************************************************************

	Function GetUpToLastTableRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim intHowManyToSkip
		intHowManyToSkip = 2
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 8) = "</TABLE>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= intHowManyToSkip Then count = 1	'exit the loop
			End If
		Next
		GetUpToLastTableRow = Mid(strHTML, 1, (LastPosition - 1))
	End Function

</SCRIPT>









<FONT FACE="Arial">

<BODY bgProperties=fixed BGCOLOR=blue noWrap ONFOCUS="clickedOn(this)" ONLOAD="BodyLoad()"
			ONMOUSEUP="CheckMinimized()">

<P ID="header" CLASS="select" ONSELECTSTART="return false">Ult2Ax Input</P>

<! <DIV id="InputFormFull">
<DIV id="FormExcludingHeading">

<hr WIDTH = "100%">

<TABLE>
    <TR>
	<TD> <IMG src=".\..\Buttons\BoxDarkLoadButton.jpg" id="cmdLoad"
		 	ONMOUSEOUT="cmdLoad.src='./../Buttons/BoxDarkLoadButton.jpg'"
			ONMOUSEOVER="cmdLoad.src='./../Buttons/BoxLightLoadButton.jpg'"
			NAME="cmdLoad" ONCLICK="LoadFile()"></TD>
    	<TD></TD>
 	<TD> <IMG src=".\..\Buttons\BoxDarkSaveButton.jpg" id="cmdSave"
		ONMOUSEOUT="cmdSave.src='./../Buttons/BoxDarkSaveButton.jpg'"
		ONMOUSEOVER="cmdSave.src='./../Buttons/BoxLightSaveButton.jpg'"
		NAME="cmdSave" ONCLICK="SaveFile()"> </TD>
	<TD id="EraseMe1"> <IMG src=".\..\Buttons\BoxLightLoadButton.jpg"> </TD>
	<TD id="EraseMe2"> <IMG src=".\..\Buttons\BoxLightSaveButton.jpg"> </TD>
    </TR>
</TABLE>

<hr WIDTH = "100%">

<H3>Concrete</H3>
<TABLE>
  <TR>
	<TD>f'<sub>c</sub> (ksi)</TD>
	<TD width=100></TD>
	<TD>Select Shapes</TD>
  <TR>
	<TD><INPUT id=txtfc ONCHANGE="fcUpdate(txtfc.value)"></TD>
	<TD width=100></TD>
	<DIV id=AreasOption>
		<TD width=50><SELECT id=optArea ONCHANGE="optAreaChanged()"><OPTION>1</OPTION></SELECT>
		</TD>
	</DIV>
  </TR>
</TABLE>

<! // First parameter of ShapesUpdate function is the LINE that these text boxes are on >
<FORM id="frmConcreteCoordinates">
<TABLE>
  <TR>
	<TD><CENTER>X (In)</CENTER></TD>
	<TD><CENTER>Y (In)</CENTER></TD>
  <TR>
	<TD><INPUT id="Text11" size="10" ONCHANGE="ShapesUpdate(1,Text11.value, Text12.value)"></TD>
	<TD><INPUT id="Text12" size="10" ONCHANGE="ShapesUpdate(1,Text11.value, Text12.value)"></TD>
  </TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\AddVerticeDarkButton.jpg" id="cmdAddVertice" 		ONMOUSEOUT="cmdAddVertice.src='./../Buttons/AddVerticeDarkButton.jpg'" 		ONMOUSEOVER="cmdAddVertice.src='./../Buttons/AddVerticeLightButton.jpg'"
		ONCLICK="AddVertice()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\DeleteVerticeDarkButton.jpg" id="cmdRemoveVertice" 		ONMOUSEOUT="cmdRemoveVertice.src='./../Buttons/DeleteVerticeDarkButton.jpg'" 		ONMOUSEOVER="cmdRemoveVertice.src='./../Buttons/DeleteVerticeLightButton.jpg'"
		ONCLICK="RemoveVertice()"></TD>
	<TD width=50></TD>
	<TD><IMG src=".\..\Buttons\AddAreaDarkButton.jpg" id="cmdAddArea" 		ONMOUSEOUT="cmdAddArea.src='./../Buttons/AddAreaDarkButton.jpg'" 		ONMOUSEOVER="cmdAddArea.src='./../Buttons/AddAreaLightButton.jpg'"
		ONCLICK="AddArea()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\DeleteAreaDarkButton.jpg" id="cmdDeleteArea"
		ONMOUSEOUT="cmdDeleteArea.src='./../Buttons/DeleteAreaDarkButton.jpg'"
		ONMOUSEOVER="cmdDeleteArea.src='./../Buttons/DeleteAreaLightButton.jpg'"
 		ONCLICK="RemoveArea()"></TD>
	<TD id="EraseMe3"> <IMG src=".\..\Buttons\AddVerticeLightButton.jpg"></TD>
	<TD id="EraseMe4"> <IMG src=".\..\Buttons\DeleteVerticeLightButton.jpg"></TD>
	<TD id="EraseMe5"> <IMG src=".\..\Buttons\AddAreaLightButton.jpg"></TD>
	<TD id="EraseMe6"> <IMG src=".\..\Buttons\DeleteAreaLightButton.jpg"></TD>
	</TR>
</TABLE>

</FORM>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>270<sup>k</sup> Strands</H4>
<FORM id=frmStrands>
<TABLE>
   <TR>
	<TD>X (In)</TD>
	<TD>Y (In)</TD>
	<TD>Area (In<sup>2</sup>)</TD>
	<TD>Pres. Level (ksi)</TD>
   <TR>
	<TD><INPUT id="txtStrand11" size="10"></TD>
	<TD><INPUT id="txtStrand12" size="10"></TD>
	<TD><INPUT id="txtStrand13" size="10"></TD>
	<TD><INPUT id="txtStrand14" size="10"></TD>
   </TR>
</TABLE>


<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddStrand"
		ONMOUSEOUT="cmdAddStrand.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddStrand.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddStrand()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveStrand"
		ONMOUSEOUT="cmdRemoveStrand.src='./../Buttons/BoxDarkDeleteButton.jpg'"
		ONMOUSEOVER="cmdRemoveStrand.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveStrand()"></TD>
	</TR>
</TABLE>

</FORM>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Individual Bars</H4>
<FORM id=frmRebar>
<TABLE>
   <TR>
	<TD>X (In)</TD>
	<TD>Y (In)</TD>
	<TD>Area (In<sup>2</sup>)</TD>
   <TR>
	<TD><INPUT id="txtRebar11" size="10"></TD>
	<TD><INPUT id="txtRebar12" size="10"></TD>
	<TD><INPUT id="txtRebar13" size="10"></TD>
   </TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddIndRebar"
		ONMOUSEOUT="cmdAddIndRebar.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddIndRebar.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddIndRebar()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveIndRebar" 		ONMOUSEOUT="cmdRemoveIndRebar.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveIndRebar.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveIndRebar()"></TD>
	</TR>
</TABLE>

</FORM>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Lines of Rebar</H4>
<FORM id=frmRebarLines>
<TABLE>
   <TR>
	<TD>Area (In<sup>2</sup>)</TD>
	<TD>X<SUB>1</SUB> (In)</TD>
	<TD>Y<SUB>1</SUB> (In)</TD>
	<TD>No.</TD>
	<TD>X<SUB>2</SUB> (In)</TD>
	<TD>Y<SUB>2</SUB> (In)</TD>
   <TR>
	<TD><INPUT id="txtNoRebar11" size="10"></TD>
	<TD><INPUT id="txtNoRebar12" size="10"></TD>
	<TD><INPUT id="txtNoRebar13" size="10"></TD>
	<TD><INPUT id="txtNoRebar14" size="10"></TD>
	<TD><INPUT id="txtNoRebar15" size="10"></TD>
	<TD><INPUT id="txtNoRebar16" size="10"></TD>
   </TR>
</TABLE>


<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddRebarLine"
		ONMOUSEOUT="cmdAddRebarLine.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddRebarLine.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddRebarLine()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveRebarLine" 		ONMOUSEOUT="cmdRemoveRebarLine.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveRebarLine.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveRebarLine()"></TD>
	</TR>
</TABLE>

</FORM>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Yield Stress PHI</H4>
<TABLE>
   <TR>
	<TD>f<SUB>Y</SUB></TD>
	<TD>Reduction factor (<bold><font face="Symbol">f</font></bold>) (ksi)</TD>
   <TR>
	<TD><INPUT id="txtYield11" size="10"></TD>
	<TD><INPUT id="txtYield12" size="10"></TD>
   </TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Readings / Total Deg. Rotation N.A.</H4>
<TABLE>
   <TR>
	<TD>No.</TD>
	<TD>Degrees</TD>
   <TR>
	<TD><INPUT id=txtReadingsNo size="10">
	<TD> <SELECT id=optReading><OPTION>0</OPTION><OPTION>90</OPTION>
		<OPTION>180</OPTION><OPTION>360</OPTION></SELECT></TD>
   </TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Axial Loads</H4>
<FORM id=frmAxialLoad>
<TABLE>
   <TR>
	<TD>X</TD>
	<TD>Y</TD>
   <TR>
	<TD><INPUT id="txtAxialX" size="10">
	<TD><INPUT id="txtAxialY" size="10">
   </TR>
</TABLE>
<TABLE>
   <TR>
	<TD>Magnitude of P (kips)</TD>
   <TR>
	<TD><INPUT id="txtMag1" size="10"></TD>
   </TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddMagnitude"
		ONMOUSEOUT="cmdAddMagnitude.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddMagnitude.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddMagnitude()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveMagnitude" 		ONMOUSEOUT="cmdRemoveMagnitude.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveMagnitude.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveMagnitude()"></TD>
	</TR>
</TABLE>
</FORM>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H4>Enter Data Then Click On "Ult2Ax Output" Frame</H4>

</DIV>
</BODY>
</FONT>
</HTML>