<!

///////////////////////////////////////////////////////////////////////
// BEToolbox - Bridge Engineering Toolbox
// Copyright (C) 2000, Washington State Department of Transportation
//                     Bridge and Structures Office
//
// This software was developed as part of the Alternate Route Project
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the Alternate Route Open Source License as
// published by the Washington State Department of Transportation,
// Bridge and Structures Office.
//
// This program is distributed in the hope that it will be useful,
// but is distributed AS IS, WITHOUT ANY WARRANTY; without even the
// implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
// PURPOSE.  See the Alternate Route Open Source License for more details.
//
// You should have received a copy of the Alternate Open Source License
// along with this program; if not, write to the Washington State
// Department of Transportation, Bridge and Structures Office,
// 4500 3rd Ave SE, P.O. Box 47340, Olympia, WA 98503, USA or e-mail
// Bridge_Support@wsdot.wa.gov
///////////////////////////////////////////////////////////////////////

>

<HTML>
<HEAD>
<TITLE>QConLE Sliding Frames</TITLE>

</HEAD>

  <SCRIPT LANGUAGE="Javascript">
    var defSize = 25;
    var _current = null;
    var old_color;
    var bLoaded = false;	//tells BoxInfo if it was just loaded or not
    var bStale = true;  // tells if analysis needs to be performed
                        // assumes that if a user visits the Input frame, he changed data

	function display(f, new_color) 
	{
		var newRows = ""
		// Check if already active
		if (f==_current) 
		{
			return;
		}

		if ( _current != null )			  //prevents errors on startup
		{
			_current.document.bgColor = old_color;    //sets the last doc to it's "min" color
			old_color = new_color;			  // saves the "min" color of curr doc

			//If it is the input form, reduce it to nothing but the title.
			// This stops problems with selecting large portions of it when opening on it again.
			if( _current != QConLEInfo )
			{
				//_current.document.all.InputFormFull.style.display="none";
				_current.document.all.FormExcludingHeading.style.display="none";
			}
		}
		else	//sets the "old_color" for the first doc to load
		{
			_current = f;
			old_color = new_color;	
			return;		
		}

		_current = f;
		_current.document.bgColor = "Silver";	//set current doc color to silver
	
		
		// Determine where the first frame is in the all collection
		var startIndex = document.body.sourceIndex+1
		for (var intFrames=0; intFrames< frames.length; intFrames++) 
		{
			var curF = frames[intFrames].document
			if (curF.body == f.document.body) 
			{
				// Give selected frame all the space
				newRows+="*,"
				// Make the header much bigger
				curF.all.header.style.fontSize="200%"
				// Change header color:
				curF.all.header.style.color="Black"
				/* Turn on scrollbars for the active frame
				This is done by accessing the FRAME element
				in this frameset document. */
				document.all[startIndex+intFrames].scrolling="auto"

				//If it is the input form, enlarge it from the title to the entire document.
				// This stops problems with selecting large portions of it when opening on it again.
				if( _current != QConLEInfo )
				{
					_current.SetJustMaximized();
				}
			}
			else 
			{
				// Set to the default size
				newRows+=defSize.toString() + ","
				// Reset header font-size
				curF.all.header.style.fontSize="" 
				// Change header color:
				if ( curF.title != "QConLE Output" )
					curF.all.header.style.color="White"
				// Turn off scrolling
				document.all[startIndex+intFrames].scrolling="no"
			}
		}
		document.body.rows=newRows   
		// Remove Selection
	}

    function Process()
    {
       var Msg;
       try 
       {
          Msg = frames(1).Process();
       }
       catch(er)
       {
          Msg = "An unknown error was caught";
       }
       
       return (Msg);
    }

  </SCRIPT>
  
  
  <FRAMESET ROWS="*, 25, 25">
    <FRAME SRC="QConLEInfo.html" NORESIZE Name="QConLEInfo">
    <FRAME SRC="QConLEInput.html" NORESIZE Name="QConLEInput">
    <FRAME SRC="QConLEOutput.html" NORESIZE Name="QConLEOutput">
  </FRAMESET>
</HTML>