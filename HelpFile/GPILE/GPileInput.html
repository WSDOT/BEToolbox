<!

///////////////////////////////////////////////////////////////////////
// BEToolbox - Bridge Engineering Toolbox
// Copyright (C) 2000, Washington State Department of Transportation
//                     Bridge and Structures Office
//
// This software was developed as part of the Alternate Route Project
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the Alternate Route Open Source License as
// published by the Washington State Department of Transportation,
// Bridge and Structures Office.
//
// This program is distributed in the hope that it will be useful,
// but is distributed AS IS, WITHOUT ANY WARRANTY; without even the
// implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
// PURPOSE.  See the Alternate Route Open Source License for more details.
//
// You should have received a copy of the Alternate Open Source License
// along with this program; if not, write to the Washington State
// Department of Transportation, Bridge and Structures Office,
// 4500 3rd Ave SE, P.O. Box 47340, Olympia, WA 98503, USA or e-mail
// Bridge_Support@wsdot.wa.gov
///////////////////////////////////////////////////////////////////////

>

<HTML>
  <HEAD>
    <TITLE>GPile Rolled Input</TITLE>
    <STYLE TYPE="text/css">
      .select {text-align:center; font-family: Arial; font-weight: bold; color: white; cursor: hand}
      body {margin-top: 0pt}
     .contents {background: blue; font-family: Arial; color: black}
	TD {font-size: 14; font-weight: bold}
    </STYLE>
  </HEAD>

<SCRIPT LANGUAGE="JavaScript">
// javascript used to manipulate form.  vbscript used to manipulate data.
// visual basic used to manipulate files.  fortran used to process data.

// Note: Throughout this page and others, the ".\..\" are dos paths for HTML and the "./../" are unix path's for
//  javascript..MUST be this way IAW http://www.cis.ohio-state.edu/htbin/rfc/rfc1738.html>

	//This variable and the next two functions help to show/hide the entire form.
	// useful in making it so header shows when form is minimized.
	// Also deselects text that may have been selected accidentally when document is clicked on.
	var bJustMaximized = false;

	function SetJustMaximized()
	{
		bJustMaximized = true;
	}

	function CheckMinimized()
	{
		if( bJustMaximized == true )
		{
			//document.all.InputFormFull.style.display="";
			document.all.FormExcludingHeading.style.display = "";
			bJustMaximized = false;
			if ( "None" != document.selection.type)
			{
				//var tr = document.body.createTextRange();
				document.selection.empty();
			}
		}
	}

	function BodyLoad()
	{
		//Erases buttons that need to be linked in for compiler to see them
		document.all.EraseMe1.innerHTML="";
		document.all.EraseMe2.innerHTML="";
		document.all.EraseMe3.innerHTML="";
		document.all.EraseMe4.innerHTML="";
		document.all.EraseMe5.innerHTML="";
		Piles = 1;
		Types = 1;
		Loads = 1;
	}

	function PicWindow()
	{
		window.open("Pictures.html", "hello",
			'scrollbars,resizable,width=185,height=441');
	}

	function clickedOn(my)
	{	//Clicked on form, so expand it and change color (old color = Blue)
		parent.display(my, "Blue");
	}

	function LoadFile()	// Load from a file
	{
		var SavedFileData = parent.LoadFile();
		if( SavedFileData != "")
		{
			ClearForm();
			Parse(SavedFileData);
		}
		focus();	//The button was given the focus, now return it to the form.
	}

	function SaveFile()	//Save to a file
	{
		var dataString = GetSaveString();
		parent.SaveFile( dataString );
		focus();	//The button was given the focus, now return it to the form.
	}

	function Process()	//Called from "Output" page...this processes the data w/Fortran dll
	{
		var dataString = CreateSaveString("Processing");
		parent.SetInputString( dataString );
		parent.Process();
	}

	function RemoveOnePile()	//Remove one row of problems.
	{
		if( Piles > 1 )
		{
			document.all.frmIndividualPiles.innerHTML =
				GetUpToNextToLastPilesRow( document.all.frmIndividualPiles.innerHTML);
			Piles--;
		}
	}

	function AddPile()		//Adds one row of problems
	{
		var strHTML = document.all.frmIndividualPiles.innerHTML;
		document.all.frmIndividualPiles.innerHTML = NewPile( strHTML );
		//Don't have to increment "Piles" cuz the last function does that for us.
	}

	function RemoveOneType()	//Remove one row of problems.
	{
		if( Types > 1 )
		{
			document.all.frmPileTypes.innerHTML =
				GetUpToNextToLastTypeRow( document.all.frmPileTypes.innerHTML );
			Types--;
		}
	}

	function AddType()		//Adds one row of problems
	{
		var strHTML = document.all.frmPileTypes.innerHTML;
		document.all.frmPileTypes.innerHTML = NewType( strHTML );
		//Don't have to increment "Types" cuz the last function does that for us.
	}

	function RemoveOneLoad()
	{
		if( Loads > 1 )
		{
			document.all.frmLoad.innerHTML =
				GetUpToNextToLastLoadRow( document.all.frmLoad.innerHTML );
			Loads--;
		}
	}

	function AddLoad()
	{
		var strHTML = document.all.frmLoad.innerHTML;
		document.all.frmLoad.innerHTML = NewLoad( strHTML );
		//Don't have to increment "Loads" cuz the last function does that for us.
	}

</SCRIPT>

<SCRIPT LANGUAGE="VBScript">

	Dim Piles
	Dim Types
	Dim Loads

	Sub ClearForm
		'Remove the "excess" rows:
		While Piles > 1
			RemoveOnePile
		Wend
		While Types > 1
			RemoveOneType
		Wend
		While Loads > 1
			RemoveOneLoad
		Wend

		document.all.Title.value = ""
		document.all.chkMatrix.checked = false

		'Clear out all the other text boxes left
		Dim count
		Dim strTextBoxName
		Dim textBox
		'Pile boxes:
		For count = 1 to 6
			strTextBoxName = "Pile1" & Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next
		'Type boxes:
		For count = 1 to 11
			strTextBoxName = "Type1" & Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next
		'Load boxes:
		For count = 1 to 7
			strTextBoxName = "Load1" & Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

	End Sub

	Function GetSaveString()   'For saving to a file, not to Fortran
		'Creates the string that will be saved to a file
		dim tmpString
		tmpString = ""
		tmpString = tmpString & "<LoadQty>," & Cstr(Loads) + Chr(13) + Chr(10)
		tmpString = tmpString & CreateSaveString( "File" )
		GetSaveString = tmpString

	End Function

    Sub Parse(text)
         'This takes the input string (from file), parses it, and then places the data inside
         '     the form.
        Dim iStartOfWord      'These are used to pull the entry out of the file
        Dim iEndOfWord
        Dim iEndOfString
        Dim count       	'cycles through the file
        Dim count2      	'open for use by anyone
        Dim strWord
        Dim iLengthOfWord
        Dim iCurrentTextBox
        Dim iCurrentTextBoxRow
        Dim strBoxName
        Dim textBox
	  Dim strSectionTag

On Error Resume Next

        iEndOfString = Len(text)
        count = 1
        iStartOfWord = 0
        iEndOfWord = 1

        For count = 1 To iEndOfString
        'If parser finds an entry:

            If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13)) Or _
			(Mid(text, count, 1) = Chr(10))) Then
		'-----Move to the next textbox or line depending on current position in line
		    If ( (Mid(text,count,1) = ",") Or (Mid(text,count,1) = Chr(13)) ) Then
			  iCurrentTextBox = iCurrentTextBox + 1
		    ElseIf Mid(text,count,1) = Chr(10) Then
			  iCurrentTextBox = 0
			  iCurrentTextBoxRow = iCurrentTextBoxRow + 1
		    End If

            '----Get a hold of the entry and assign to "strWord"
                iEndOfWord = count
                iLengthOfWord = ((iEndOfWord - 1) - (iStartOfWord))
                strWord = Mid(text, iStartOfWord + 1, iLengthOfWord)
                If Left(strWord,1) = Chr(10) Then strWord = Mid(strWord,2,(len(strWord)-1))
                iStartOfWord = iEndOfWord

	          If ((strWord <> Chr(13)) AND (strWord <> Chr(10)) _
			   And (strWord <> "" )) Then

			Select Case strSectionTag
				Case "LoadQty"
					For count2 = 2 to CInt(strWord)
						AddLoad
					Next
					strSectionTag = ""
				Case "Title"
					document.all.Title.value = strWord
					strSectionTag = ""
				Case "Header"
					Select Case iCurrentTextBox
						Case 1	'Set how many Piles there are
							For count2 = 2 to CInt(strWord)
								AddPile
							Next
						Case 2	'Set how many Pile Types there are
							For count2 = 2 to CInt(strWord)
								AddType
							Next
						Case 3	'Set the Matrix checkbox
							If trim(strWord) = "0" Then
								document.all.chkMatrix.checked = false
								strSectionTag = ""
							Else
								document.all.chkMatrix.checked = true
								strSectionTag = ""
							End If
					End Select
				Case "Pile"		'Enter Pile data into textboxes
					strBoxName = "Pile" & Cstr(iCurrentTextBoxRow) & Cstr(iCurrentTextBox)
					Set textBox = document.all.Item(strBoxName)
					textBox.value = strWord
					If ((iCurrentTextBoxRow = Piles) And (iCurrentTextBox = 6)) Then
						iCurrentTextBoxRow = 0
						strSectionTag = ""
					End If
				Case "Types"	'Enter Type data into textboxes
					strBoxName = "Type" & Cstr(iCurrentTextBoxRow) & Cstr(iCurrentTextBox)
					Set textBox = document.all.Item(strBoxName)
					textBox.value = strWord
					If ((iCurrentTextBoxRow = Types) And (iCurrentTextBox = 11)) Then
						iCurrentTextBoxRow = 0
						strSectionTag = ""
					End If
				Case "Load"		'Enter Load data into textboxes
					strBoxName = "Load" & Cstr(iCurrentTextBoxRow) & Cstr(iCurrentTextBox)
					Set textBox = document.all.Item(strBoxName)
					textBox.value = strWord
					If ((iCurrentTextBoxRow = Loads) And (iCurrentTextBox = 7)) Then
						iCurrentTextBoxRow = 0
						strSectionTag = ""
					End If
			End Select

			'If it is a tag, then set the section tag
			If Mid(strWord,1,1) = "<" Then
				strSectionTag = Mid(strWord,2,(len(strWord)-2))
				iCurrentTextBoxRow = 0	'Resets it so can easily enter data into textboxes
				iCurrentTextBox = 1
			End If
		  End If
            End If
        Next

'Parse Error:
If Err.Number > 4 Then
	msgbox "You may be using a corrupted file.  Please contact Software Support."
	Exit Sub
End If

    End Sub


	Function CreateSaveString( fileFormat )     'Takes form data and converts it to a string
							  		  ' used for both saving the file and for
							 		  ' processing by the Fortran dll.
		Dim strName
		Dim strHeader
		Dim strPile
		Dim strType
		Dim strLoad
		Dim tmpVar
		Dim textBox
		Dim textBoxName
		Dim tmpTemp		'For whatever

		'Get Name:
		strName = ""
		If fileFormat = "File" Then strName = strName & "<Title>" + Chr(13) + Chr(10)
		strName = strName & document.all.Title.value
		If Trim(strName) = "" Then strName = "None"
		strName = strName + Chr(13) + Chr(10)

		'Get Header:
		tmpVar = document.all.chkMatrix.checked
		If tmpVar = false Then
			tmpVar = "0"
		Else
			tmpVar = "1"
		End If
		strHeader = ""
		If fileFormat = "File" Then strHeader = strHeader & "<Header>" + Chr(13) + Chr(10)
		strHeader = strHeader & Cstr(Piles) & "," & Cstr(Types) & "," & tmpVar + Chr(13) + Chr(10)

		'Get all Piles:
		Dim iPileEntry
		Dim iPileRow
		strPile = ""
		If fileFormat = "File" Then strPile = strPile & "<Pile>" + Chr(13) + Chr(10)
		For iPileRow = 1 to Piles
			For iPileEntry = 1 to 6
				textBoxName = "Pile" & Cstr(iPileRow) & Cstr(iPileEntry)
				Set textBox = document.all.Item(textBoxName)
				tmpTemp = textBox.value
				If Trim(tmpTemp) = "" Then tmpTemp = "0"
				If iPileEntry < 6 Then
					strPile = strPile & tmpTemp & ","
				Else
					If tmpTemp = "0" Then tmpTemp = "1"		'Avoids having the fortran access nothing
					strPile = strPile & tmpTemp			' (array out of bounds error)
				End If
			Next
			strPile = strPile + Chr(13) + Chr(10)
		Next

		'Get all Types:
		Dim iTypeEntry
		Dim iTypeRow
		strType = ""
		If fileFormat = "File" Then strType = strType & "<Types>" + Chr(13) + Chr(10)
		For iTypeRow = 1 to Types
			For iTypeEntry = 1 to 11
				textBoxName = "Type" & Cstr(iTypeRow) & Cstr(iTypeEntry)
				Set textBox = document.all.Item(textBoxName)
				tmpTemp = textBox.value
				If iTypeEntry = 1 And tmpTemp = "" Then tmpTemp = "1"
				If Trim(tmpTemp) = "" Then tmpTemp = "0"
				If iTypeEntry < 11 Then
					strType = strType & tmpTemp & ","
				Else
					strType = strType & tmpTemp
				End If
			Next
			strType = strType + Chr(13) + Chr(10)
		Next

		'Get all Loads:
		Dim iLoadEntry
		Dim iLoadRow
		strLoad = ""
		If fileFormat = "File" Then strLoad = strLoad & "<Load>" + Chr(13) + Chr(10)
		For iLoadRow = 1 to Loads
			For iLoadEntry = 1 to 7
				textBoxName = "Load" & Cstr(iLoadRow) & Cstr(iLoadEntry)
				Set textBox = document.all.Item(textBoxName)
				tmpTemp = textBox.value
				If Trim(tmpTemp) = "" Then tmpTemp = "0"
				If iLoadEntry < 7 Then
					strLoad = strLoad & tmpTemp & ","
				Else
					strLoad = strLoad & tmpTemp
				End If
			Next
			strLoad = strLoad + Chr(13) + Chr(10)
		Next

		CreateSaveString = strName & strHeader & strPile & strType & strLoad

	End Function


'****************************************************************************************
'These "GetUpToNextTOLast???Row" functions are used to dynamically delete rows of problems.
'  What these functions do is retrieve a "form", delete everything following the next-to-last-row
'  (thereby eliminating the last row), then appending the end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function GetUpToNextToLastPilesRow( strHTML )
		dim LastPosition
		dim count
		dim count2
		dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then 'OR (Mid(strHTML, count, 5) = "<tr>")) Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 14 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "</TABLE><TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddPile""" & _
				"ONMOUSEOUT=""cmdAddPile.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddPile.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddPile""" & _
		 		"ONCLICK=""AddPile()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemovePile""" & _
				"ONMOUSEOUT=""cmdRemovePile.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemovePile.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemovePile"" ONCLICK=""RemoveOnePile()""></TD>" & _
				"</TR></TABLE><hr WIDTH = ""100%""><hr WIDTH = ""100%"">"

		GetUpToNextToLastPilesRow = tmpString
	End Function


'****************************************************************************************
'These "New???" functions are used to dynamically insert one new row (problems).
'  What these functions do is retrieve a "form", delete everything following the last-row
'  (the end tags), then appending the new row tags/end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function NewPile( oldHTML )
		dim count
		dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML, 13 )
		Piles = Piles + 1
			strNewString = "<TR><TR><TR><TR><TR><TR><TR><TD><BIG><U>Pile# " & _
				Cstr(Piles) & "</U></BIG></TD>" & _
				"<TR>" & _
					"<TD width=10><B>X</B></TD>" & _
					"<TD width=10><B>Y</B></TD>" & _
					"<TD width=10><B>Z</B></TD>" & _
					"<TD width=20><B><font face=""Symbol"">b</font></B></TD>" & _
					"<TD width=20><B>Batter</B></TD>" & _
					"<TD width=20><B>Pile Type</B></TD>" & _
					"<TR>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "1"" size=""10"" > </TD>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "2"" size=""10"" > </TD>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "3"" size=""10"" > </TD>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "4"" size=""10"" > </TD>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "5"" size=""10"" > </TD>" & _
					"<TD> <INPUT id=""Pile" & Cstr(Piles) & "6"" size=""10"" > </TD>" & _
					"</TR>" & _
				"</TABLE>"

		strNewString = strNewString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddPile""" & _
				"ONMOUSEOUT=""cmdAddPile.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddPile.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""CmdAddPile""" & _
		 		"ONCLICK=""AddPile()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemovePile""" & _
				"ONMOUSEOUT=""cmdRemovePile.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemovePile.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemovePile"" ONCLICK=""RemoveOnePile()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"
		NewPile = oldHTML + strNewString
	End Function


'****************************************************************************************
' This function takes a piece of HTML retrieved from a "form", then gives you back the
'   HTML without the end tags (everything after the last row of problems).
'****************************************************************************************

	Function GetUpToLastTableRow( strHTML, intHowManyToSkip )
		Dim LastPosition
		Dim count
		Dim count2
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 5) = "</TR>") Then 'Or ((Mid(strHTML, count, 4) = "<TR>")
				LastPosition = count
				count2 = count2 + 1
				If count2 >= intHowManyToSkip Then count = 1	'exit the loop
			End If
		Next
		GetUpToLastTableRow = Mid(strHTML, 1, (LastPosition - 1))
	End Function


	Function NewType(oldHTML)
		Dim count
		Dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML, 6 )
		Types = Types + 1
			strNewString = "<TR><TR><TR><TR><TR><TR><TR>" & _
				"<TD width=10><B>Pile Type</B></TD>" & _
				"<TD width=10><B>Fu/<font face=""Symbol"">d</font>u</B></TD>" & _
				"<TD width=10><B>Fv/<font face=""Symbol"">d</font>v</B></TD>" & _
				"<TD width=20><B>Fw/<font face=""Symbol"">d</font>w</B></TD>" & _
				"<TD width=20><B>Mu/<font face=""Symbol"">q</font>u</B></TD>" & _
				"<TD width=20><B>Mv/<font face=""Symbol"">q</font>v</B></TD>" & _
				"<TD width=20><B>Mw/<font face=""Symbol"">q</font>w</B></TD>" & _
				"<TR>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "1"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "2"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "3"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "4"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "5"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "6"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "7"" size=""10"" > </TD>" & _
				"<TR>" & _
				"<TD>" & _
				"<TD width=10><B>Mw/<font face=""Symbol"">d</font>v</B></TD>" & _
				"<TD width=10><B>Fv/<font face=""Symbol"">d</font>w</B></TD>" & _
				"<TD width=20><B>Fw/<font face=""Symbol"">q</font>v</B></TD>" & _
				"<TD width=20><B>Mv/<font face=""Symbol"">q</font>w</B></TD>" & _
				"<TR>" & _
				"<TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "8"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "9"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "10"" size=""10"" > </TD>" & _
				"<TD> <INPUT id=""Type" & Cstr(Types) & "11"" size=""10"" > </TD>" & _
				"<TR>" & _
				"</TR>" & _
				"</TABLE>"

		strNewString = strNewString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddType""" & _
				"ONMOUSEOUT=""cmdAddType.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddType.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddType""" & _
		 		"ONCLICK=""AddType()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveType""" & _
				"ONMOUSEOUT=""cmdRemoveType.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveType.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveType"" ONCLICK=""RemoveOneType()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"
		NewType = oldHTML + strNewString

	End Function

	Function GetUpToNextToLastTypeRow( strHTML )
		dim LastPosition
		dim count
		dim count2
		dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 16 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddType""" & _
				"ONMOUSEOUT=""cmdAddType.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddType.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""CmdAddType""" & _
		 		"ONCLICK=""AddType()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveType""" & _
				"ONMOUSEOUT=""cmdRemoveType.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveType.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveType"" ONCLICK=""RemoveOneType()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"

		GetUpToNextToLastTypeRow = tmpString
	End Function


	Function NewLoad( oldHTML )
		dim count
		dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML, 6 )
		Loads = Loads + 1
			strNewString = "" & _
				"<TR>" & _
				"<TD width=10><B>Load No.</B></TD>" & _
				"<TD width=10><B>Fx</B></TD>" & _
				"<TD width=10><B>Fy</B></TD>" & _
				"<TD width=10><B>Fz</B></TD>" & _
				"<TD width=10><B>Mx</B></TD>" & _
				"<TD width=10><B>My</B></TD>" & _
				"<TD width=10><B>Mz</B></TD>" & _
				"<TR>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "1"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "2"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "3"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "4"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "5"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "6"" size=""10""> </TD>" & _
				"<TD> <INPUT id=""Load" & Cstr(Loads) & "7"" size=""10""> </TD>" & _
				"<TR>" & _
				"</TR>" & _
				"</TABLE>"

		strNewString = strNewString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddLoad""" & _
				"ONMOUSEOUT=""cmdAddLoad.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddLoad.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddLoad""" & _
		 		"ONCLICK=""AddLoad()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveLoad""" & _
				"ONMOUSEOUT=""cmdRemoveLoad.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveLoad.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveLoad"" ONCLICK=""RemoveOneLoad()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"
		NewLoad = oldHTML + strNewString
	End Function

	Function GetUpToNextToLastLoadRow( strHTML )
		dim LastPosition
		dim count
		dim count2
		dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 8 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddType""" & _
				"ONMOUSEOUT=""cmdAddLoad.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddLoad.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddLoad""" & _
		 		"ONCLICK=""AddLoad()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveLoad""" & _
				"ONMOUSEOUT=""cmdRemoveLoad.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveLoad.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveLoad"" ONCLICK=""RemoveOneLoad()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"

		GetUpToNextToLastLoadRow = tmpString
	End Function

</SCRIPT>









<FONT FACE="Arial">

<BODY bgProperties=fixed BGCOLOR=blue noWrap ONFOCUS="clickedOn(this)" ONLOAD="BodyLoad()"
			ONMOUSEUP="CheckMinimized()">

   <P ID="header" CLASS="select" ONSELECTSTART="return false">GPile Input</P>

<! <DIV id="InputFormFull">
<DIV id="FormExcludingHeading">

<hr WIDTH = "100%">

<TABLE>
    <TR>
	<TD> <IMG src=".\..\Buttons\BoxDarkLoadButton.jpg" id="cmdLoad"
		 	ONMOUSEOUT="cmdLoad.src='./../Buttons/BoxDarkLoadButton.jpg'"
			ONMOUSEOVER="cmdLoad.src='./../Buttons/BoxLightLoadButton.jpg'"
			NAME="cmdLoad" ONCLICK="LoadFile()" > </TD>
    	<TD></TD>
 	<TD> <IMG src=".\..\Buttons\BoxDarkSaveButton.jpg" id="cmdSave"
		ONMOUSEOUT="cmdSave.src='./../Buttons/BoxDarkSaveButton.jpg'"
		ONMOUSEOVER="cmdSave.src='./../Buttons/BoxLightSaveButton.jpg'"
		NAME="cmdSave" ONCLICK="SaveFile()"> </TD>
	<TD id="EraseMe1"> <IMG src=".\..\Buttons\BoxLightLoadButton.jpg"> </TD>
	<TD id="EraseMe2"> <IMG src=".\..\Buttons\BoxLightSaveButton.jpg"> </TD>
	<TD id="EraseMe3"> <IMG src=".\..\Buttons\BoxLightViewPicButton.jpg"></TD>
	<TD width=50></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkViewPicButton.jpg" id="cmdPicWindow"
		 	ONMOUSEOUT="cmdPicWindow.src='./../Buttons/BoxDarkViewPicButton.jpg'"
			ONMOUSEOVER="cmdPicWindow.src='./../Buttons/BoxLightViewPicButton.jpg'"
			NAME="cmdPicWindow" ONCLICK="PicWindow()" > </TD>
    </TR>
</TABLE>

<hr WIDTH = "100%">

<TABLE>
    <TR>
	<TD><B>Title</B></TD>
	<TR>
	<TD><INPUT id="Title" size="80" ></TD>
    </TR>
</TABLE>
<hr WIDTH = "100%">
<hr WIDTH = "100%">

<TABLE>
	<TR>
	<TD><B>Output To Include Matrices?</B></TD>
	<TR>
	<TD><INPUT TYPE="CHECKBOX" NAME="chkMatrix" ID="chkMatrix"></INPUT></TD>
	</TR>
</TABLE>
</FORM>
<hr WIDTH = "100%">
<hr WIDTH = "100%">

<H2>Piles</H2>
<H3>Create One Line For Each Pile</H3>

<FORM id=frmIndividualPiles>

<TABLE>
	<TR>
	<TD><BIG><U>Pile# 1</U></BIG></TD>
	<TR>
	<TD width=10><B>X</B></TD>
	<TD width=10><B>Y</B></TD>
	<TD width=10><B>Z</B></TD>
	<TD width=20><B><font face="Symbol">b</font></B></TD>
	<TD width=20><B>Batter</B></TD>
	<TD width=20><B>Pile Type</B></TD>
	<TR>
	<TD> <INPUT id="Pile11" size="10"> </TD>
	<TD> <INPUT id="Pile12" size="10"> </TD>
	<TD> <INPUT id="Pile13" size="10"> </TD>
	<TD> <INPUT id="Pile14" size="10"> </TD>
	<TD> <INPUT id="Pile15" size="10"> </TD>
	<TD> <INPUT id="Pile16" size="10"> </TD>
	<TR>
	</TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddPile"
		ONMOUSEOUT="cmdAddPile.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddPile.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddPile()"></TD>
	<TD id="EraseMe4"><IMG src=".\..\Buttons\BoxLightAddButton.jpg"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemovePile" 		ONMOUSEOUT="cmdRemovePile.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemovePile.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveOnePile()"></TD>
	<TD id="EraseMe5"><IMG src=".\..\Buttons\BoxLightDeleteButton.jpg"></TD>
	</TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">
</FORM>

<H2>Pile Types</H2>
<H3>Create One Description For Each Pile Type</H3>

<FORM id=frmPileTypes>

<TABLE>
	<TR>
	<TD width=10><B>Pile Type</B></TD>
	<TD width=10><B>Fu/<font face="Symbol">d</font>u</B></TD>
	<TD width=10><B>Fv/<font face="Symbol">d</font>v</B></TD>
	<TD width=20><B>Fw/<font face="Symbol">d</font>w</B></TD>
	<TD width=20><B>Mu/<font face="Symbol">q</font>u</B></TD>
	<TD width=20><B>Mv/<font face="Symbol">q</font>v</B></TD>
	<TD width=20><B>Mw/<font face="Symbol">q</font>w</B></TD>
	<TR>
	<TD><INPUT id="Type11" size="10"></TD>
	<TD><INPUT id="Type12" size="10"></TD>
	<TD><INPUT id="Type13" size="10"></TD>
	<TD><INPUT id="Type14" size="10"></TD>
	<TD><INPUT id="Type15" size="10"></TD>
	<TD><INPUT id="Type16" size="10"></TD>
	<TD><INPUT id="Type17" size="10"></TD>
	<TR>
	<TD></TD>
	<TD width=10><B>Mw/<font face="Symbol">d</font>v</B></TD>
	<TD width=10><B>Fv/<font face="Symbol">d</font>w</B></TD>
	<TD width=20><B>Fw/<font face="Symbol">q</font>v</B></TD>
	<TD width=20><B>Mv/<font face="Symbol">q</font>w</B></TD>
	<TR>
	<TD></TD>
	<TD><INPUT id="Type18" size="10"></TD>
	<TD><INPUT id="Type19" size="10"></TD>
	<TD><INPUT id="Type110" size="10"></TD>
	<TD><INPUT id="Type111" size="10"></TD>
	<TR>
	</TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddType"
		ONMOUSEOUT="cmdAddType.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddType.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddType()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveType" 		ONMOUSEOUT="cmdRemoveType.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveType.src='./../Buttons/BoxLightDeleteButton.jpg'"
 		ONCLICK="RemoveOneType()"></TD>
	</TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

</FORM>

<H2>Loads</H2>

<FORM id=frmLoad>

<TABLE>
	<TR>
	<TD width=10><B>Load No.</B></TD>
	<TD width=10><B>Fx</B></TD>
	<TD width=10><B>Fy</B></TD>
	<TD width=10><B>Fz</B></TD>
	<TD width=10><B>Mx</B></TD>
	<TD width=10><B>My</B></TD>
	<TD width=10><B>Mz</B></TD>
	<TR>
	<TD><INPUT id="Load11" size="10"></TD>
	<TD><INPUT id="Load12" size="10"></TD>
	<TD><INPUT id="Load13" size="10"></TD>
	<TD><INPUT id="Load14" size="10"></TD>
	<TD><INPUT id="Load15" size="10"></TD>
	<TD><INPUT id="Load16" size="10"></TD>
	<TD><INPUT id="Load17" size="10"></TD>
	<TR>
	</TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddLoad"
		ONMOUSEOUT="cmdAddLoad.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddLoad.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddLoad()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveLoad" 		ONMOUSEOUT="cmdRemoveLoad.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveLoad.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveOneLoad()"></TD>
	</TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

</FORM>

<H3>Enter Data Then Click On "GPile Output" Frame</H3>

</DIV>
</BODY>
</FONT>
</HTML>