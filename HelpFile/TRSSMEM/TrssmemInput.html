<!

///////////////////////////////////////////////////////////////////////
// BEToolbox - Bridge Engineering Toolbox
// Copyright (C) 2000, Washington State Department of Transportation
//                     Bridge and Structures Office
//
// This software was developed as part of the Alternate Route Project
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the Alternate Route Open Source License as
// published by the Washington State Department of Transportation,
// Bridge and Structures Office.
//
// This program is distributed in the hope that it will be useful,
// but is distributed AS IS, WITHOUT ANY WARRANTY; without even the
// implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
// PURPOSE.  See the Alternate Route Open Source License for more details.
//
// You should have received a copy of the Alternate Open Source License
// along with this program; if not, write to the Washington State
// Department of Transportation, Bridge and Structures Office,
// 4500 3rd Ave SE, P.O. Box 47340, Olympia, WA 98503, USA or e-mail
// Bridge_Support@wsdot.wa.gov
///////////////////////////////////////////////////////////////////////

>

<HTML>
  <HEAD>
    <TITLE>Trssmem Input</TITLE>
    <STYLE TYPE="text/css">
      .select {text-align:center; font-family: Arial; font-weight: bold; color: white; cursor: hand}
      body {margin-top: 0pt}
     .contents {background: blue; font-family: Arial; color: black}
	TD {font-size: 14; font-weight: bold}
    </STYLE>
  </HEAD>

<SCRIPT LANGUAGE="JavaScript">
// javascript used to manipulate form.  vbscript used to manipulate data.
// visual basic used to manipulate files.  fortran used to process data.

// Note: Throughout this page and others, the ".\..\" are dos paths for HTML and the "./../" are unix path's for
//  javascript..MUST be this way IAW http://www.cis.ohio-state.edu/htbin/rfc/rfc1738.html>

	//This variable and the next two functions help to show/hide the entire form.
	// useful in making it so header shows when form is minimized.
	// Also deselects text that may have been selected accidentally when document is clicked on.
	var bJustMaximized = false;

	function SetJustMaximized()
	{	// Page was just maximized (from a small frame to a large one)
		bJustMaximized = true;
	}

	function CheckMinimized()
	{	// Document's just been maximized, so show the page and unselect anything selected
		if( bJustMaximized == true )
		{
			//document.all.InputFormFull.style.display="";
			document.all.FormExcludingHeading.style.display="";
			bJustMaximized = false;
			if ( "None" != document.selection.type )
			{
				document.selection.empty();
			}
		}
	}

	function BodyLoad()
	{
		//Erases buttons that need to be linked in for compiler to see them
		document.all.EraseMe1.innerHTML="";
		document.all.EraseMe2.innerHTML="";
		document.all.EraseMe3.innerHTML="";
		document.all.EraseMe4.innerHTML="";

		Problem = 1;		// Form just loaded and only one problem exists
	}


	function clickedOn(my)
	{	//Clicked on form, so expand it and change color (old color = Blue)
		parent.display(my, "Blue");
	}

	function LoadFile()	// Load from a file
	{
		var SavedFileData = parent.LoadFile();
		if( SavedFileData != "")
		{
			ClearForm();
			Parse(SavedFileData);
		}
		focus();	//The button was given the focus, now return it to the form.
	}

	function SaveFile()	//Save to a file
	{
		var dataString = CreateSaveString();
		parent.SaveFile( dataString );
		focus();	//The button was given the focus, now return it to the form.
	}

	function Process()	//Called from "Output" page...this processes the data w/Fortran dll
	{
		var dataString = CreateSaveString();
		parent.SetInputString( dataString );
		parent.Process();
	}

	function RemoveProblem()	//Remove one row of problems.
	{
		if( Problem > 1 )
		{
			document.all.inputForm.innerHTML =
				GetUpToNextToLastProblemRow( document.all.inputForm.innerHTML);
			Problem--;
		}
	}

	function AddProblem()		//Adds one row of problems
	{
		var strHTML = document.all.inputForm.innerHTML;
		document.all.inputForm.innerHTML = NewProblem( strHTML );
		//Don't have to increment "Problem" cuz the last function does that for us.
	}


</SCRIPT>

<SCRIPT LANGUAGE="VBScript">

	Dim Problem		'Keeps track of how many problems there are

	Sub ClearForm
		' Clears textboxes, etc
		Dim count
		Dim strTextBoxName
		Dim textBox

		While Problem > 1
			RemoveProblem
		Wend

		For count = 1 to 9
			strTextBoxName = "Line1" & Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

	End Sub


    Sub Parse(text)
        'This takes the input string (from file), parses it, and then places the data inside
        '     the form.
        Dim iStartOfWord      'These are used to pull the entry out of the file
        Dim iEndOfWord
        Dim iEndOfString
        Dim count             'cycles through the file
        Dim strWord
        Dim iLengthOfWord
	  Dim iCurrentTextBox
        Dim iCurrentTextBoxRow
        Dim strBoxName
        Dim textBox

On Error Resume Next

        iEndOfString = Len(text)
        count = 1
        iStartOfWord = 0
        iEndOfWord = 1
	  iCurrentTextBoxRow = 1
	  iCurrentTextBox = 0

        For count = 1 To iEndOfString
        'If parser finds an entry:

            If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13)) Or _
            (Mid(text, count, 1) = Chr(10))) Then
            '-----Move to the next textbox or line depending on current position in line
                If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13))) Then
			  iCurrentTextBox = iCurrentTextBox + 1
                ElseIf Mid(text, count, 1) = Chr(10) Then
                    iCurrentTextBoxRow = iCurrentTextBoxRow + 1
			  iCurrentTextBox = 0
                End If

                '----Get a hold of the entry and assign to "strWord"
                iEndOfWord = count
                iLengthOfWord = ((iEndOfWord - 1) - (iStartOfWord))
                strWord = Mid(text, iStartOfWord + 1, iLengthOfWord)
                If Left(strWord, 1) = Chr(10) Then strWord = Mid(strWord, 2, (Len(strWord) - 1))
                iStartOfWord = iEndOfWord

                If ((strWord <> Chr(13)) And (strWord <> Chr(10)) _
                 And (strWord <> "")) Then
				If ((iCurrentTextBox = 1) And (iCurrentTextBoxRow > 1)) Then AddProblem()
				strBoxName = "Line" + Cstr(iCurrentTextBoxRow) + Cstr(iCurrentTextBox)
				Set textBox = document.all.Item(strBoxName)
				textBox.value = strWord
                End If
            End If

'Parse Error:
If Err.Number > 4 Then
	msgbox "You may be using a corrupted file.  Please contact Software Support."
	Exit Sub
End If

        Next

    End Sub



	Function CreateSaveString()     'Takes form data and converts it to a string
				 		  ' used for processing by the Fortran dll and/or to save data to file.
		Dim strName
		Dim textBox
		Dim textBoxName
		Dim count
		Dim count2
		Dim tmpLineString
		Dim tmpFullString
		tmpLineString = ""
		tmpFullString = ""

		For count = 1 to Problem
			For count2 = 1 to 9
				textBoxName = "Line" + Cstr(count) + Cstr(count2)
				Set textBox = document.all.Item(textBoxName)
				If Trim(textBox.value) = "" Then
				        tmpLineString = tmpLineString + "0,"
				Else
				        tmpLineString = tmpLineString + Trim(textBox.value) & ","
				End If
			Next
			'Get rid of last comma in line:
			tmpLineString = Mid(tmpLineString, 1, Len(tmpLineString) - 1)
			'Add linefeed:
			tmpLineString = tmpLineString + Chr(13) + Chr(10)
			tmpFullString = tmpFullString + tmpLineString
			tmpLineString = ""
		Next

		CreateSaveString = tmpFullString
		Set textBox = nothing

	End Function

'****************************************************************************************
'These "GetUpToNextTOLast???Row" functions are used to dynamically delete rows of problems.
'  What these functions do is retrieve a "form", delete everything following the next-to-last-row
'  (thereby eliminating the last row), then appending the end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function GetUpToNextToLastProblemRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "</TABLE><TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddProblem""" & _
				"ONMOUSEOUT=""cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddProblem""" & _
		 		"ONCLICK=""AddProblem()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveProblem""" & _
				"ONMOUSEOUT=""cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveProblem"" ONCLICK=""RemoveProblem()""></TD>" & _
				"</TR></TABLE><hr WIDTH = ""100%""><hr WIDTH = ""100%"">"

		GetUpToNextToLastProblemRow = tmpString
	End Function


'****************************************************************************************
'These "New???" functions are used to dynamically insert one new row (problems).
'  What these functions do is retrieve a "form", delete everything following the last-row
'  (the end tags), then appending the new row tags/end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function NewProblem( oldHTML )
		dim count
		dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		Problem = Problem + 1
		strNewString = "<tr>" & _
				"<td width=""11%""><INPUT id=""Line" & Cstr(Problem) & "1"" size=""9""></td>" & _
				"<td width=""11%""><INPUT id=""Line" & Cstr(Problem) & "2"" size=""9""></td>" & _
				"<td width=""11%""><INPUT id=""Line" & Cstr(Problem) & "3"" size=""9""></td>" & _
				"<td width=""11%""><INPUT id=""Line" & Cstr(Problem) & "4"" size=""9""></td>" & _
				"<td width=15></td>" & _
				"<td width=""14%""><INPUT id=""Line" & Cstr(Problem) & "5"" size=""12""></td>" & _
				"<td width=""14%""><INPUT id=""Line" & Cstr(Problem) & "6"" size=""12""></td>" & _
				"<td width=""14%""><INPUT id=""Line" & Cstr(Problem) & "7"" size=""12""></td>" & _
				"<td width=15></td>" & _
				"<td width=""6%""><INPUT id=""Line" & Cstr(Problem) & "8"" size=""4""></td>" & _
				"<td width=""6%""><INPUT id=""Line" & Cstr(Problem) & "9"" size=""4""></td>" & _
				"</tr>"


		strNewString = strNewString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddProblem""" & _
				"ONMOUSEOUT=""cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddProblem""" & _
		 		"ONCLICK=""AddProblem()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveProblem""" & _
				"ONMOUSEOUT=""cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveProblem"" ONCLICK=""RemoveProblem()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"
		NewProblem = oldHTML + strNewString
	End Function


'****************************************************************************************
' This function takes a piece of HTML retrieved from a "form", then gives you back the
'   HTML without the end tags (everything after the last row of problems).
'****************************************************************************************

	Function GetUpToLastTableRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim intHowManyToSkip
		intHowManyToSkip = 2
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 8) = "</TABLE>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= intHowManyToSkip Then count = 1	'exit the loop
			End If
		Next
		GetUpToLastTableRow = Mid(strHTML, 1, (LastPosition - 1))
	End Function

</SCRIPT>









<FONT FACE="Arial">

<BODY bgProperties=fixed BGCOLOR=blue noWrap ONFOCUS="clickedOn(this)" ONLOAD="BodyLoad()"
			ONMOUSEUP="CheckMinimized()">

<P ID="header" CLASS="select" ONSELECTSTART="return false">Trssmem Input</P>

<! <DIV id="InputFormFull">
<DIV id="FormExcludingHeading">

<CENTER><IMG src=".\..\Pics\TRSSMEMPic.jpg"></CENTER>

<hr WIDTH = "100%">

<TABLE>
    <TR>
	<TD> <IMG src=".\..\Buttons\BoxDarkLoadButton.jpg" id="cmdLoad"
		 	ONMOUSEOUT="cmdLoad.src='./../Buttons/BoxDarkLoadButton.jpg'"
			ONMOUSEOVER="cmdLoad.src='./../Buttons/BoxLightLoadButton.jpg'"
			NAME="cmdLoad" ONCLICK="LoadFile()"></TD>
    	<TD></TD>
 	<TD> <IMG src=".\..\Buttons\BoxDarkSaveButton.jpg" id="cmdSave"
		ONMOUSEOUT="cmdSave.src='./../Buttons/BoxDarkSaveButton.jpg'"
		ONMOUSEOVER="cmdSave.src='./../Buttons/BoxLightSaveButton.jpg'"
		NAME="cmdSave" ONCLICK="SaveFile()"> </TD>
	<TD id="EraseMe1"> <IMG src=".\..\Buttons\BoxLightLoadButton.jpg"> </TD>
	<TD id="EraseMe2"> <IMG src=".\..\Buttons\BoxLightSaveButton.jpg"> </TD>
    </TR>
</TABLE>

<hr WIDTH = "100%">

<table width="100%">
  <tr>
    <td width="44%"><p align="center"><strong>Side Plates</strong></td>
    <td width="41%"><p align="center"><strong>Cover Plates</strong></td>
    <td width="12%"><p align="center"><strong>*</strong></td>
  </tr>
</table>

<FORM id="inputForm">

<table>
  <TR>
    <td width="11%"><p align="center"><strong>R. Width (W) (in.)</strong></td>
    <td width="11%" align="center"><strong>R. Thick. (W)</strong></td>
    <td width="11%" align="center"><strong>% (in.)</strong></td>
    <td width="11%" align="center"><strong>Lin. in. out</strong></td>
    <td width=15></td>
    <td width="14%" align="center"><strong>R. Width (in.)</strong></td>
    <td width="14%" align="center"><strong>R. Thick (in.)</strong></td>
    <td width="14%" align="center"><strong>H.H. Width</strong></td>
    <td width=15></td>
    <td width="6%" align="center"><strong>No. Plates</strong></td>
    <td width="6%" align="center"><strong>No. Cov. R.</strong></td>
  </TR>
  <TR>
    <td width="11%"><INPUT id="Line11" size="9"></td>
    <td width="11%"><INPUT id="Line12" size="9"></td>
    <td width="11%"><INPUT id="Line13" size="9"></td>
    <td width="11%"><INPUT id="Line14" size="9"></td>
    <td width=15></td>
    <td width="14%"><INPUT id="Line15" size="12"></td>
    <td width="14%"><INPUT id="Line16" size="12"></td>
    <td width="14%"><INPUT id="Line17" size="12"></td>
    <td width=15></td>
    <td width="6%"><INPUT id="Line18" size="4"></td>
    <td width="6%"><INPUT id="Line19" size="4"></td>
  </TR>
</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddProblem"
		ONMOUSEOUT="cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'"
 		ONCLICK="AddProblem()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveProblem" 		ONMOUSEOUT="cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'"
		ONCLICK="RemoveProblem()"></TD>
	<TD id="EraseMe3"> <IMG src=".\..\Buttons\BoxLightAddButton.jpg"></TD>
	<TD id="EraseMe4"> <IMG src=".\..\Buttons\BoxLightDeleteButton.jpg"></TD>
	</TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

</FORM>

<H3>Enter Data Then Click On "Trssmem Output" Frame</H3>

</DIV>
</BODY>
</FONT>
</HTML>