<!

///////////////////////////////////////////////////////////////////////
// BEToolbox - Bridge Engineering Toolbox
// Copyright (C) 2000, Washington State Department of Transportation
//                     Bridge and Structures Office
//
// This software was developed as part of the Alternate Route Project
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the Alternate Route Open Source License as
// published by the Washington State Department of Transportation,
// Bridge and Structures Office.
//
// This program is distributed in the hope that it will be useful,
// but is distributed AS IS, WITHOUT ANY WARRANTY; without even the
// implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
// PURPOSE.  See the Alternate Route Open Source License for more details.
//
// You should have received a copy of the Alternate Open Source License
// along with this program; if not, write to the Washington State
// Department of Transportation, Bridge and Structures Office,
// 4500 3rd Ave SE, P.O. Box 47340, Olympia, WA 98503, USA or e-mail
// Bridge_Support@wsdot.wa.gov
///////////////////////////////////////////////////////////////////////

>

<HTML>
  <HEAD>
    <TITLE>Box Girder Input</TITLE>
    <STYLE TYPE="text/css">
      .select {text-align:center; font-family: Arial; font-weight: bold; color: white; cursor: hand}
      body {margin-top: 0pt}
     .contents {background: blue; font-family: Arial; color: black}
	TD {font-size: 14}
    </STYLE>
  </HEAD>

<SCRIPT LANGUAGE="JavaScript">
//This JavaScript used to process files and control DHTML

// Note: Throughout this page and others, the ".\..\" are dos paths for HTML and the "./../" are unix path's for
//  javascript..MUST be this way>

	//This variable and the next two functions help to show/hide the entire form.
	// useful in making it so header shows when form is minimized.
	// Also deselects text that may have been selected accidentally when document is clicked on.
	var bJustMaximized = false;

	function SetJustMaximized()
	{
		bJustMaximized = true;
	}

	function CheckMinimized()
	{
		if( bJustMaximized == true )
		{
			//document.all.InputFormFull.style.display="";
			document.all.FormExcludingHeading.style.display="";
			bJustMaximized = false;
			if ( "None" != document.selection.type)
			{
				document.selection.empty();
			}
		}
	}

	// Clicked on form, so display it and set the color for when it is minimized.
	function clickedOn(my)
	{
		parent.display(my, "Blue");
	}

	function LoadFile()
	{
		ClearForm();
		var SavedFileData = parent.LoadFile();
		Parse(SavedFileData);
		focus();	//The button was given the focus, now return it to the form.
	}

	function SaveFile()
	{
		var dataString = GetString();
		parent.SaveFile( dataString );
		focus();	//The button was given the focus, now return it to the form.
	}

	function Process()
	{
		if( parent.InputStringFull )
		{
			var dataString = GetString();
			parent.SetInputString( dataString );
		}

		parent.Process();
	}

	function BodyLoad()
	{
		// This function is totally needed.  Why?  Because the HTML Help compiler does
		//  not recognize images unless there is a specific IMG SRC to link it in...this
		//  does NOT include putting this in a "MOUSEOVER" event or such.  Therefore,
		//  I had to create additional "spots" within the two tables (for buttons) and
		//  put xtra images (which are called through "MOUSEOVER").  BUT, I don't want
		//  these images to appear to the user until the MOUSEOVER event occurs, so this
		//  function erases them as soon as they appear.
		document.all.EraseMe1.innerHTML="";
		document.all.EraseMe2.innerHTML="";
		document.all.EraseMe3.innerHTML="";
		document.all.EraseMe4.innerHTML="";
		Problems = 1;

	}

	function RemoveProblem()	//Remove one row of problems.
	{
		if( Problems > 1 )
		{
			document.all.inputForm.innerHTML =
				GetUpToNextToLastProblemRow( document.all.inputForm.innerHTML);
			Problems--;
		}
	}

	function AddProblem()		//Adds one row of problems
	{
		var strHTML = document.all.inputForm.innerHTML;
		document.all.inputForm.innerHTML = NewProblem( strHTML );
		//Don't have to increment "Problems" cuz the last function does that for us.
	}

</SCRIPT>

<SCRIPT LANGUAGE="VBScript">

	Dim Problems

'This VBScript is used to Process data and to call javascript which manipulates
'  files

	Sub ClearForm()
		Dim count
		Dim strTextBoxName
		Dim textBox

		For count = 2 to Problems '(don't erase first one)
			RemoveProblem
		Next

		For count = 1 to 15
			strTextBoxName = "Line1" & Cstr(count)
			Set textBox = document.all.Item(strTextBoxName)
			textBox.value = ""
		Next

	End Sub

	Function GetString() 'Takes data from form and puts it into a file
	                     '  (both for a saved file, or for the Fortran)
		Dim iRows
		Dim iColumns
		Dim tmpString
		Dim strTextBoxName
		Dim textBox

		tmpString = ""
		'Create first line.  The second entry (the "1" is required by the fortran)
		If Trim(document.all.txtIdent.value) = "" Then
		        tmpString = "0,1," & Cstr(Problems) + Chr(13) + Chr(10)
		Else
		        tmpString = Trim(document.all.txtIdent.value) & ",1," & Cstr(Problems) + Chr(13) + Chr(10)
		End If

		For iRows = 1 to Problems
			For iColumns = 1 to 15
				strTextBoxName = "Line" & Cstr(iRows) & Cstr(iColumns)
				Set textBox = document.all.Item(strTextBoxName)
				If Trim(textBox.value) = "" Then
				        tmpString = tmpString & "0" & ","
				Else
				        tmpString = tmpString & Trim(textBox.value) & ","
				End If
			Next
			'Get rid of last comma:
			tmpString = Mid(tmpString, 1, (len(tmpString) - 1) )
			'Add a linefeed:
			tmpString = tmpString + Chr(13) + Chr(10)
		Next

		GetString = tmpString
		tmpString = ""
	End Function


Sub Parse(text)
       'This takes the input string (from file), parses it, and then places the data inside
        '     the form.
        Dim iStartOfWord      'These are used to pull the entry out of the file
        Dim iEndOfWord
        Dim iEndOfString
        Dim count             'cycles through the file
        Dim strWord
        Dim iLengthOfWord
	  Dim iCurrentTextBox
        Dim iCurrentTextBoxRow
        Dim strBoxName
        Dim textBox
        Dim tmpProblems

        iEndOfString = Len(text)
        count = 1
        iStartOfWord = 0
        iEndOfWord = 1
	  iCurrentTextBoxRow = 1
	  iCurrentTextBox = 0

On Error Resume Next

        For count = 1 To iEndOfString
        'If parser finds an entry:

            If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13)) Or _
            (Mid(text, count, 1) = Chr(10))) Then
            '-----Move to the next textbox or line depending on current position in line
                If ((Mid(text, count, 1) = ",") Or (Mid(text, count, 1) = Chr(13))) Then
			  iCurrentTextBox = iCurrentTextBox + 1
                ElseIf Mid(text, count, 1) = Chr(10) Then
                    iCurrentTextBoxRow = iCurrentTextBoxRow + 1
			  iCurrentTextBox = 0
                End If

                '----Get a hold of the entry and assign to "strWord"
                iEndOfWord = count
                iLengthOfWord = ((iEndOfWord - 1) - (iStartOfWord))
                strWord = Mid(text, iStartOfWord + 1, iLengthOfWord)
                If Left(strWord, 1) = Chr(10) Then strWord = Mid(strWord, 2, (Len(strWord) - 1))
                iStartOfWord = iEndOfWord

                If ((strWord <> Chr(13)) And (strWord <> Chr(10)) _
                 And (strWord <> "")) Then
				If iCurrentTextBoxRow = 1 Then
					If iCurrentTextBox = 1 Then
						document.all.txtIdent.value = strWord
					ElseIf iCurrentTextBox = 2 Then
						'Do Nothing
					ElseIf iCurrentTextBox = 3 Then
						tmpProblems = Cint(strWord)	'actual "Problems" defined in "AddProblem"
						If tmpProblems > 1 Then
							For count2 = 1 to ( tmpProblems - 1)
								'Add problem rows
								AddProblem()
							Next
						Else
							Problems = 1
						End If
					End If
				Else
					strBoxName = "Line" & Cstr( Cint(iCurrentTextBoxRow ) - 1 ) & _
						Cstr(iCurrentTextBox)
					Set textBox = document.all.Item(strBoxName)
					textBox.value = strWord
				End If
		     End If
		End If

'Parse Error:
If Err.Number > 4 Then
	msgbox "You may be using a corrupted file.  Please contact Software Support."
	Exit Sub
End If

	  Next

        iStartOfWord = 0
        iEndOfWord = 0
        iEndOfString = 0
        count = 0
        strWord = ""
        iLengthOfWord = 0
        iCurrentTextBox = 0
        iCurrentTextBoxRow = 0
        strBoxName = ""
        Set textBox = nothing

End Sub


'****************************************************************************************
'These "GetUpToNextTOLast???Row" functions are used to dynamically delete rows of problems.
'  What these functions do is retrieve a "form", delete everything following the next-to-last-row
'  (thereby eliminating the last row), then appending the end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function GetUpToNextToLastProblemRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim tmpString
		count2 = 0
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 4) = "<TR>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= 6 Then count = 1	'exit the loop
			End If
		Next
		tmpString = Mid(strHTML, 1, (LastPosition - 1))
		tmpString = tmpString + "</TABLE><TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddProblem""" & _
				"ONMOUSEOUT=""cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddProblem""" & _
		 		"ONCLICK=""AddProblem()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveProblem""" & _
				"ONMOUSEOUT=""cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveProblem"" ONCLICK=""RemoveProblem()""></TD>" & _
				"</TR></TABLE><hr WIDTH = ""100%""><hr WIDTH = ""100%"">"

		GetUpToNextToLastProblemRow = tmpString
	End Function


'****************************************************************************************
'These "New???" functions are used to dynamically insert one new row (problems).
'  What these functions do is retrieve a "form", delete everything following the last-row
'  (the end tags), then appending the new row tags/end tags/buttons to the end of the string,
'  and then placing the new string back into the form.
'****************************************************************************************

	Function NewProblem( oldHTML )
		dim count
		dim strNewString
		strNewString = ""
		oldHTML = GetUpToLastTableRow( oldHTML )
		Problems = Problems + 1
		strNewString = "<TR>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "1"" size=""1""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "2"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "3"" size=""5""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "4"" size=""2""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "5"" size=""5""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "6"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "7"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "8"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "9"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "10"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "11"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "12"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "13"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "14"" size=""4""></TD>" & _
			"<TD><INPUT id=""Line" & Cstr(Problems) & "15"" size=""4""></TD>" & _
			"</TR></TABLE>"

		strNewString = strNewString + "<TABLE><TR></TR><TR></TR><TR></TR><TR></TR><TD>" & _
				"<IMG src="".\..\Buttons\BoxDarkAddButton.jpg"" id=""cmdAddProblem""" & _
				"ONMOUSEOUT=""cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'""" & _
				"ONMOUSEOVER=""cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'""" & _
				"NAME=""cmdAddProblem""" & _
		 		"ONCLICK=""AddProblem()""></TD><TD></TD>" & _
				"<TD><IMG src="".\..\Buttons\BoxDarkDeleteButton.jpg"" id=""cmdRemoveProblem""" & _
				"ONMOUSEOUT=""cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'""" & _
				"ONMOUSEOVER=""cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'""" & _
				"NAME=""cmdRemoveProblem"" ONCLICK=""RemoveProblem()""></TD>" & _
				"</TR></TABLE> <hr WIDTH = ""100%""><hr WIDTH = ""100%"">"
		NewProblem = oldHTML + strNewString
	End Function


'****************************************************************************************
' This function takes a piece of HTML retrieved from a "form", then gives you back the
'   HTML without the end tags (everything after the last row of problems).
'****************************************************************************************

	Function GetUpToLastTableRow( strHTML )
		Dim LastPosition
		Dim count
		Dim count2
		Dim intHowManyToSkip
		intHowManyToSkip = 2
		LastPosition = len(strHTML)
		For count = LastPosition to 1 Step -1
			If (Mid(strHTML, count, 8) = "</TABLE>") Then
				LastPosition = count
				count2 = count2 + 1
				If count2 >= intHowManyToSkip Then count = 1	'exit the loop
			End If
		Next
		GetUpToLastTableRow = Mid(strHTML, 1, (LastPosition - 1))
	End Function

</SCRIPT>

<FONT FACE="Arial">

<BODY bgProperties=fixed BGCOLOR=blue noWrap ONFOCUS="clickedOn(this)" ONLOAD="BodyLoad()"
		ONMOUSEUP="CheckMinimized()">

   <P ID="header" CLASS="select" ONSELECTSTART="return false">
      Box Girder Input
   </P>

<! <DIV id="InputFormFull">
<DIV id="FormExcludingHeading">

<H4>Box Girder Diagram</H4>
<IMG src=".\..\Pics\boxdiagram.jpg">

<H2>Box Girder Section Properties:</H2>
<hr WIDTH = "100%">

<TABLE>
    <TR>
	<TD> <IMG src=".\..\Buttons\BoxDarkLoadButton.jpg" id="cmdLoad" ONMOUSEOUT="cmdLoad.src='./../Buttons/BoxDarkLoadButton.jpg'" ONMOUSEOVER="cmdLoad.src='./../Buttons/BoxLightLoadButton.jpg'" ONCLICK="LoadFile()" >
            </TD>
    	<TD></TD>
	<TD> <IMG src=".\..\Buttons\BoxDarkSaveButton.jpg" id="cmdSave" ONMOUSEOUT="cmdSave.src='./../Buttons/BoxDarkSaveButton.jpg'" ONMOUSEOVER="cmdSave.src='./../Buttons/BoxLightSaveButton.jpg'" ONCLICK="SaveFile()">
            </TD>
	<TD id="EraseMe1"> <IMG src=".\..\Buttons\BoxLightLoadButton.jpg"> </TD>
	<TD id="EraseMe2"> <IMG src=".\..\Buttons\BoxLightSaveButton.jpg"> </TD>
    </TR>
</TABLE>

<hr WIDTH = "100%">

<H2>Description:</H2>

<FORM id=inputForm>

<TABLE>
    <TR>
	<TD WIDTH="50"><B> IDENT: </B></TD>
	<TD> <INPUT id=txtIdent size="10" > </TD>
    </TD>
    </TR>
</TABLE>
<TABLE>
    <TR>
    <TR>
    <TR>
    <TR>
    <TR>
	<TD WIDTH="20"><B> No </B></TD>
	<TD WIDTH="30"><B> D </B></TD>
	<TD WIDTH="30"><B> T </B></TD>
	<TD WIDTH="20"><B> No of webs </B></TD>
	<TD WIDTH="30"><B> W (Ft) </B></TD>
	<TD WIDTH="30"><B> ST (In) </B></TD>
	<TD WIDTH="30"><B> SB (In) </B></TD>
	<TD WIDTH="30"><B> FT (In) </B></TD>
	<TD WIDTH="30"><B> FB (In) </B></TD>
	<TD WIDTH="30"><B> EL (Ft.) </B></TD>
	<TD WIDTH="30"><B> CL (In.) </B></TD>
	<TD WIDTH="30"><B> BL (Ft.) </B></TD>
	<TD WIDTH="30"><B> ER (Ft.) </B></TD>
	<TD WIDTH="30"><B> CR (In) </B></TD>
	<TD WIDTH="30"><B> BR (Ft) </B></TD>
    <TR>
	<TD><INPUT id="Line11" size="1"></TD>
	<TD><INPUT id="Line12" size="4"></TD>
	<TD><INPUT id="Line13" size="5"></TD>
	<TD><INPUT id="Line14" size="2"></TD>
	<TD><INPUT id="Line15" size="5"></TD>
	<TD><INPUT id="Line16" size="4"></TD>
	<TD><INPUT id="Line17" size="4"></TD>
	<TD><INPUT id="Line18" size="4"></TD>
	<TD><INPUT id="Line19" size="4"></TD>
	<TD><INPUT id="Line110" size="4"></TD>
	<TD><INPUT id="Line111" size="4"></TD>
	<TD><INPUT id="Line112" size="4"></TD>
	<TD><INPUT id="Line113" size="4"></TD>
	<TD><INPUT id="Line114" size="4"></TD>
	<TD><INPUT id="Line115" size="4"></TD>
    </TR>

</TABLE>

<TABLE>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR></TR>
	<TR>
	<TD><IMG src=".\..\Buttons\BoxDarkAddButton.jpg" id="cmdAddProblem"
		ONMOUSEOUT="cmdAddProblem.src='./../Buttons/BoxDarkAddButton.jpg'"
		ONMOUSEOVER="cmdAddProblem.src='./../Buttons/BoxLightAddButton.jpg'" NAME="cmdAddProblem"
 		ONCLICK="AddProblem()"></TD>
	<TD></TD>
	<TD><IMG src=".\..\Buttons\BoxDarkDeleteButton.jpg" id="cmdRemoveProblem" 		ONMOUSEOUT="cmdRemoveProblem.src='./../Buttons/BoxDarkDeleteButton.jpg'" 		ONMOUSEOVER="cmdRemoveProblem.src='./../Buttons/BoxLightDeleteButton.jpg'" NAME="cmdRemoveProblem" 		ONCLICK="RemoveProblem()"></TD>
	<TD id="EraseMe3"> <IMG src=".\..\Buttons\BoxLightAddButton.jpg"></TD>
	<TD id="EraseMe4"> <IMG src=".\..\Buttons\BoxLightDeleteButton.jpg"></TD>
	</TR>
</TABLE>

<hr WIDTH = "100%">
<hr WIDTH = "100%">

</FORM>

<H3>Enter Data Then Click On "Box Girder Output" Frame</H3>

</DIV>
</BODY>
</FONT>
</HTML>
